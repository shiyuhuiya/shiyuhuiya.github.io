<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>vue | 三叶的博客</title><meta name="author" content="三叶sanye"><meta name="copyright" content="三叶sanye"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="关于vue的绝大部分知识点都在前端面试—vue部分 | 三叶的博客这篇文章中讲了，这里就说说基础语法 关于vue的绝大部分知识点都在前端面试—vue部分 | 三叶的博客这篇文章中讲了，这里就说说基础语法    Vue2插值表达式利用表达式进行插值，渲染数据到页面中 123&lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;&#x2F;h3&gt;&lt;p&gt;&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="vue">
<meta property="og:url" content="https://www.sanye.blog/posts/8b27fabc.html">
<meta property="og:site_name" content="三叶的博客">
<meta property="og:description" content="关于vue的绝大部分知识点都在前端面试—vue部分 | 三叶的博客这篇文章中讲了，这里就说说基础语法 关于vue的绝大部分知识点都在前端面试—vue部分 | 三叶的博客这篇文章中讲了，这里就说说基础语法    Vue2插值表达式利用表达式进行插值，渲染数据到页面中 123&lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;&#x2F;h3&gt;&lt;p&gt;&amp;#">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.sanye.blog/images/cover/preview.jpg">
<meta property="article:published_time" content="2025-01-25T14:00:18.000Z">
<meta property="article:modified_time" content="2025-03-12T05:56:48.215Z">
<meta property="article:author" content="三叶sanye">
<meta property="article:tag" content="vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.sanye.blog/images/cover/preview.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.sanye.blog/posts/8b27fabc.html"><link rel="preconnect" href="//unpkg.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-center"},
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'vue',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/bilibiliBanner.css"  media="defer" onload="this.media='screen'"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/time.css"><link rel="stylesheet" href="/css/iconfont.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="iron-container iron-circle"><div class="iron-box1 iron-circle iron-center"></div><div class="iron-box2 iron-circle iron-center"></div><div class="iron-box3 iron-circle iron-center"></div><div class="iron-box4 iron-circle iron-center"></div><div class="iron-box5 iron-circle iron-center"></div><div class="iron-box6 iron-circle"><div class="iron-coil" style="--i: 0"></div><div class="iron-coil" style="--i: 1"></div><div class="iron-coil" style="--i: 2"></div><div class="iron-coil" style="--i: 3"></div><div class="iron-coil" style="--i: 4"></div><div class="iron-coil" style="--i: 5"></div><div class="iron-coil" style="--i: 6"></div><div class="iron-coil" style="--i: 7"></div></div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/%E4%B8%89%E5%8F%B6.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/cover/forest2.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name iconfont icon-sanyecao">三叶的博客</span></a><a class="nav-page-title" href="/"><span class="site-name iconfont icon-sanyecao">vue</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">vue<a class="post-edit-link" href="https://github.com/shiyuhuiya/shiyuhuiya.github.io/issues_posts/vue.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-01-25T14:00:18.000Z" title="发表于 2025-01-25 22:00:18">2025-01-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-12T05:56:48.215Z" title="更新于 2025-03-12 13:56:48">2025-03-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/vue/">vue</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">15.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>59分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2025-03-12 13:56:48&quot;}" hidden></div><blockquote>
<p>关于vue的绝大部分知识点都在<a href="https://www.sanye.blog/posts/f33bd2b9.html">前端面试—vue部分 | 三叶的博客</a>这篇文章中讲了，这里就说说基础语法</p>
<p>关于vue的绝大部分知识点都在<a href="https://www.sanye.blog/posts/f33bd2b9.html">前端面试—vue部分 | 三叶的博客</a>这篇文章中讲了，这里就说说基础语法</p>
</blockquote>
<img src="..\images\vue\vue.png" style="zoom:67%;" />

<h1 id="Vue2"><a href="#Vue2" class="headerlink" title="Vue2"></a>Vue2</h1><h2 id="插值表达式"><a href="#插值表达式" class="headerlink" title="插值表达式"></a>插值表达式</h2><p>利用表达式进行插值，渲染数据到页面中</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;nickname.toUppercase()&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;age &gt;= 18 ?&#x27;成年’:&#x27;未成年&#x27;&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：不能写到标签内部，表达式涉及到的数据必须存在。</p>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><p>带有<code>v-前缀</code>的特殊标签属性，Vue会根据不同的【指令】，针对标签实现不同的【功能】</p>
<h3 id="v-html"><a href="#v-html" class="headerlink" title="v-html"></a>v-html</h3><p>设置元素的innerHTML</p>
<h3 id="v-if-v-show"><a href="#v-if-v-show" class="headerlink" title="v-if&#x2F;v-show"></a>v-if&#x2F;v-show</h3><p>用来控制元素显示隐藏。</p>
<p>v-show&#x3D;”表达式”，表达式值true显示， false隐藏</p>
<p>v-if&#x3D;”表达式”，表达式值true显示， false隐藏</p>
<p>二者的区别可以参考：<a href="https://www.sanye.blog/posts/f33bd2b9.html">前端面试—vue部分 | 三叶的博客</a></p>
<h3 id="v-else-v-else-if"><a href="#v-else-v-else-if" class="headerlink" title="v-else&#x2F;v-else-if"></a>v-else&#x2F;v-else-if</h3><p>配合v-if使用，v-show没有这个待遇，语法和C语言的if-else语法差不多。</p>
<h3 id="v-on"><a href="#v-on" class="headerlink" title="v-on"></a>v-on</h3><p>注册事件。免去了<code>手动捕获元素</code>，<code>添加事件监听</code>的工作，只需专心书写<code>回调逻辑</code>，极大地简化了事件监听的代码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v-<span class="attr">on</span>:事件名 = <span class="string">&quot;内联语句&quot;</span><span class="comment">//js代码</span></span><br><span class="line">v-<span class="attr">on</span>:事件名 = <span class="string">&quot;methods中的函数名&quot;</span></span><br><span class="line">@事件名=<span class="string">&quot;&quot;</span> <span class="comment">//简写</span></span><br></pre></td></tr></table></figure>

<h3 id="v-bind"><a href="#v-bind" class="headerlink" title="v-bind"></a>v-bind</h3><p><code>动态</code>的设置标签属性src url title …</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v-<span class="attr">bind</span>:属性名 = <span class="string">&quot;表达式&quot;</span></span><br><span class="line">:属性名=<span class="string">&quot;表达式&quot;</span> <span class="comment">//简写</span></span><br></pre></td></tr></table></figure>

<p><strong>动态样式控制</strong></p>
<p>借助v-bind指令可以很方便的实现动态控制样式</p>
<ul>
<li><p><code>:class = &quot;数组/对象&quot;</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;[类名1,类名2,类名3 ]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>//添加到数组中表示这个类名生效</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;类名1:布尔值,类名2:布尔值&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>//布尔值为true表示添加这个类</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>:style =&quot;样式对象&quot;</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//属性值可以是表达式</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;CSS属性名1:CSS属性值,CSS属性名2:CSS属性值&#125; &quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">//原生行内写法,属性值不能是表达式，是写死的，用分号分隔样式</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span> <span class="attr">style</span>=<span class="string">&quot;dispaly:none;width:100px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="v-for"><a href="#v-for" class="headerlink" title="v-for"></a>v-for</h3><p>基于数据循环，多次渲染整个元素，哪个标签需要多次渲染就加到哪个元素身上。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(value, key, index) in obj&quot;</span>&gt;</span></span><br><span class="line">      Key: &#123;&#123; key &#125;&#125;, Value: &#123;&#123; value &#125;&#125;, Index: &#123;&#123; index &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span>//只有一个变量就是value，两个第二个就是key，三个第三个就是index</span><br></pre></td></tr></table></figure>

<p>关于给标签添加<code>key</code>的作用，还有<code>v-if</code>和<code>v-for</code>优先级问题以及能否一起使用的问题，参考<a href="https://www.sanye.blog/posts/f33bd2b9.html">前端面试—vue部分 | 三叶的博客</a></p>
<h3 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h3><p>给表单元素使用，双向数据绑定，可以快速获取或设置表单元素内容。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;a&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>本质上是一个语法糖：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;a&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;(e)=&gt;&#123;a = e.target.value&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>应用于其他表单元素:</p>
<ul>
<li><p>checkbox：绑定一个布尔值变量，true表示选中</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:checked</span>=<span class="string">&quot;a&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;(e)=&gt;&#123;a = e.target.checked&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>radio</p>
<p>给同一组radio绑定相同的变量，点击哪个就会把哪个的value赋值给变量</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>男</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>女</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>sync</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:message.sync</span>=<span class="string">&quot;parentMessage&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// ...</span></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>:[<span class="string">&#x27;message&#x27;</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateMessage</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;update:message&#x27;</span>, newValue);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>sync</code>修饰符通常与<code>v-bind</code>指令一起使用，用来简化子组件向父组件通信的代码，就是<strong>不需要手动在组件上添加自定义事件，也不需要书写对应的回调逻辑</strong>，</p>
<p>而是使用提供的<code>默认事件</code>，就能实现子组件和父组件通信，从而实现<strong>双向数据通信</strong>，</p>
<p>简单的来说，在vue2中，v-bind加上sync修饰符仿佛就实现了<code>组件自己v-model指令</code></p>
<p>因为在vue2中直接给组件使用v-model，就意味着只能传入value，监听的事件只能是input，而借助sync就能指定多个传入子组件的属性</p>
<p>和对应的事件。所以说<code>sync</code>和<code>v-bind</code>就是用来解决vue2中，v-model应用在组件上功能不足的问题。</p>
<p>在 Vue 3 中，<code>.sync</code> 修饰符<strong>已经被移除</strong>，推荐的做法是使用<code>自定义事件（就是手动给组件标签添加事件监听并传入事件回调）</code>或 <code>v-model </code>来达到类似的效果。</p>
<p>vue 3 对 <code>v-model</code> 进行了<strong>增强</strong>，使其更加灵活，允许在一个组件上使用<strong>多个</strong> <code>v-model</code> 绑定，并且可以自定义绑定的<code>prop</code> 和 <code>event</code> 名称。</p>
<p><strong>默认情况</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/*父组件*/</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model</span>=<span class="string">&quot;message&quot;</span> /&gt;</span></span><br><span class="line">  /*等价于: <span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:modelValue</span>=<span class="string">&quot;message&quot;</span> @<span class="attr">update:modelValue</span>=<span class="string">&quot;(val)=&gt;&#123;modelValue=val&#125;&quot;</span> /&gt;</span>*/</span><br><span class="line">  /*如果在vue2中就等价于*/</span><br><span class="line">  /*等价于: <span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:value</span>=<span class="string">&quot;message&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;(val)=&gt;&#123;message=val&#125;&quot;</span> /&gt;</span>*/</span><br><span class="line">  /*val是子组件传递过来的值*/</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">ChildComponent</span> <span class="keyword">from</span> <span class="string">&#x27;./ChildComponent.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">components</span>: &#123; <span class="title class_">ChildComponent</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> message = <span class="title function_">ref</span>(<span class="string">&#x27;Hello from parent&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123; message &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/*子组件内*/</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  /*回调函数直接书写行内代码，其中$event指向原生事件对象*/</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">:value</span>=<span class="string">&quot;modelValue&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;$emit(&#x27;update:modelValue&#x27;, $event.target.value)&quot;</span> /&gt;</span></span><br><span class="line">  /*等价于<span class="tag">&lt;<span class="name">input</span> <span class="attr">:value</span>=<span class="string">&quot;modelValue&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;(e)=&gt;&#123;$emit(&#x27;update:modelValue&#x27;,e.target.value)&#125;&quot;</span> /&gt;</span>*/</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">modelValue</span>: <span class="title class_">String</span> <span class="comment">// 默认情况下，v-model 在组件内使用的 prop 名称为 modelValue</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>$emit</code>是<code>this.$emit</code>的简写，this指向当前<code>组件实例</code>，在模板中可以省略</p>
</li>
<li><p><code> $event</code>是在<strong>模板中</strong>的<code>事件处理器</code>中使用的<strong>特殊变量</strong>，用于引用<code>原生的事件对象</code>。</p>
<p>而在原生dom中，可以直接使用<code>event</code>代替原生事件对象</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;event.preventDefault()&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>&lt;input @input=&quot;logValue($event)&quot;&gt;</code>和<code>&lt;input @input=&quot;logValue&quot;&gt;</code>这两种写法效果都是一样的</p>
</li>
<li><p>要注意的是，给<code>组件</code>添加事件监听和给<code>dom元素</code>添加事件监听，都传入一个回调函数，但不同的是，Vue 组件中的事件是<code>自定义事件</code>，不是浏览器<code>原生的 DOM 事件</code>，没有与之相关的 <code>event（事件）</code> 对象，对于<code>组件的自定义事件</code>的回调函数，传入的第一个参数其实是<code>子组件通过emit传递过来的值</code>，后者传入的则是<code>事件对象event</code>。</p>
</li>
</ul>
<p>Vue 3 支持在一个组件上使用多个 <code>v-model</code> 绑定。这可以通过指定<strong>自定义</strong>的 prop 和 event 名称来实现</p>
<p>在vue2中的<code>:message.sync</code>等价于vue3中的<code>v-model:message</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/*父组件*/</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model:title</span>=<span class="string">&quot;pageTitle&quot;</span> <span class="attr">v-model:description</span>=<span class="string">&quot;pageDescription&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">ChildComponent</span> <span class="keyword">from</span> <span class="string">&#x27;./ChildComponent.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">components</span>: &#123; <span class="title class_">ChildComponent</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pageTitle = <span class="title function_">ref</span>(<span class="string">&#x27;Default Title&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pageDescription = <span class="title function_">ref</span>(<span class="string">&#x27;Default Description&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123; pageTitle, pageDescription &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/*子组件*/</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    /*因为我们要做的不是直接修改title的值，所以不能使用v-model*/</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">:value</span>=<span class="string">&quot;title&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;$emit(&#x27;update:title&#x27;, $event.target.value)&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">:value</span>=<span class="string">&quot;description&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;$emit(&#x27;update:description&#x27;, $event.target.value)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">title</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">description</span>: <span class="title class_">String</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="指令修饰符"><a href="#指令修饰符" class="headerlink" title="指令修饰符"></a>指令修饰符</h3><p>参考<a href="https://www.sanye.blog/posts/f33bd2b9.html">前端面试—vue部分 | 三叶的博客</a></p>
<h2 id="计算属性computed"><a href="#计算属性computed" class="headerlink" title="计算属性computed"></a>计算属性computed</h2><ul>
<li><p>基于现有的数据，计算出来的新属性。依赖的数据变化，自动重新计算。</p>
</li>
<li><p>使用起来和普通数据一样： <code>&#123;&#123;计算属性名&#125;&#125;</code></p>
</li>
</ul>
<p>简写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">	计算属性名()&#123;</span><br><span class="line">		<span class="comment">//基于现有数据,编写求值逻辑</span></span><br><span class="line">        <span class="keyword">return</span> 结果</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>完整写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">	计算属性名:&#123;</span><br><span class="line">		<span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">			<span class="comment">//一段代码逻辑（计算逻辑）</span></span><br><span class="line">            <span class="keyword">return</span> 结果</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="title function_">set</span>(<span class="params">修改的值</span>)&#123;</span><br><span class="line">			<span class="comment">//一段代码逻辑（修改逻辑）</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>计算属性一般只用来展示，赋值。如果尝试直接修改计算属性，并不会生效，因为计算属性的值只与其相关的数据有关，但是会把<code>传入的值</code>传递到set函数，set函数拿到这个值可以做一些操作。</p>
</li>
<li><p>依赖的数据必须是<strong>响应式的</strong>（即 <code>data</code> 或其他计算属性），不然依赖的数据改变了计算属性也无法发觉，就不会即时更新。</p>
</li>
<li><p>当计算属性依赖的任何数据发生变化时，Vue 会标记计算属性为<code>脏</code>，并在下次访问时重新计算其值。计算属性采用<strong>惰性求值</strong>策略（被访问的时候再求值），并具有<strong>缓存机制</strong>（如果依赖的数据未改变，直接使用缓存，而不需要重新计算），只有当依赖的数据发生变化，即被标记为<code>脏</code>，并被访问的时候，才会重新计算其值。</p>
</li>
<li><p>同时计算属性也是<strong>响应式的</strong>，当计算属性的值改变，也会通知计算属性的依赖更新。</p>
</li>
<li><p>因为计算属性和data的用法是一样的，都属于响应式数据，它们<strong>收集依赖</strong>的方式也是一样的，都是被访问的时候，通过getter方法收集。</p>
</li>
<li><p>计算属性在<strong>首次计算</strong>其值时，通过访问响应式数据，触发响应式数据的 <code>getter</code> 方法，成功收集计算属性为它们的依赖。</p>
</li>
</ul>
<h2 id="监听器watch"><a href="#监听器watch" class="headerlink" title="监听器watch"></a>监听器watch</h2><p>用来监视<code>data</code>和<code>计算属性</code>中数据的变化。</p>
<p>简写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>:&#123;</span><br><span class="line">	<span class="comment">//检测words数据变化</span></span><br><span class="line">	<span class="title function_">words</span>(<span class="params">newValue,oldvalue</span>) &#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;变化了&#x27;</span>,newValue,oldvalue)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//检测obj中的words数据变化</span></span><br><span class="line">	<span class="string">&quot;obj.words&quot;</span>(newValue,oldvalue)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;变化了&#x27;</span>,newValue,oldvalue)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="comment">//和计算属性配置一样，都是直接放函数</span></span><br></pre></td></tr></table></figure>

<p>完整写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">	数据属性名:&#123;</span><br><span class="line">        <span class="attr">immediate</span>: <span class="literal">true</span><span class="comment">//初始化立刻执行一次handler方法</span></span><br><span class="line">        <span class="attr">deep</span>: <span class="literal">true</span>,<span class="comment">//深度监视</span></span><br><span class="line">        <span class="title function_">handler</span>(<span class="params">newValue，oldValue</span>)&#123;</span><br><span class="line">			<span class="variable language_">console</span>.<span class="title function_">log</span>(newValue)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>deep: true</code>，开启对复杂类型深度监视后，可以监听一整个对象，可以监听这个对象中的全部属性，否则监听的只是对象的地址变化。</p>
<p>通过vue实例的<code>$watch</code>方法也能添加监听</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vue.$watch(<span class="string">&#x27;监听的数据&#x27;</span>,&#123;<span class="comment">//配置对象&#125;)//完整写法</span></span><br><span class="line">vue.$watch(<span class="string">&#x27;监听的数据&#x27;</span>,<span class="keyword">function</span>(<span class="params">newValue,oldValue</span>)&#123;&#125;) <span class="comment">//简写   </span></span><br></pre></td></tr></table></figure>

<p>watch监听的数据必须是响应式的，然而在vue2中数据默认都是响应式的。</p>
<p>watch可以理解为用来自定义扩充某个响应式数据的setter方法体。</p>
<h2 id="watch和computed的区别与联系"><a href="#watch和computed的区别与联系" class="headerlink" title="watch和computed的区别与联系"></a>watch和computed的区别与联系</h2><ul>
<li><p>watch，computed和视图，这三者都依赖响应式数据，是响应式数据的三大订阅者，而响应式数据又包括data中的数据和计算属性。</p>
</li>
<li><p>在watch里可以写异步操作，但是在computed内部不适合写异步操作，比如无法异步返回值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">computed</span>:&#123;</span><br><span class="line">        <span class="title function_">sum</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">price</span>*<span class="variable language_">this</span>.<span class="property">num</span>&#125;,<span class="number">1000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>computed能做的，用watch也能实现，就是更为麻烦；但是watch能做的，computed不一定能实现，比如延迟几秒更新数据。</p>
</li>
</ul>
<h2 id="method和computed的区别与联系"><a href="#method和computed的区别与联系" class="headerlink" title="method和computed的区别与联系"></a>method和computed的区别与联系</h2><p>我们讨论的是<code>有返回值的方法</code>和<code>computed</code>的区别于联系</p>
<ul>
<li>当某个数据属性的值发生变化时，Vue 会自动检测到这个变化，并重新计算依赖于这个数据属性的任何方法，对于计算属性则是标记为’脏’</li>
<li>计算属性本质就是一个有返回值的方法</li>
<li>计算属性存在<strong>缓存机制</strong>，无论被使用多少次，只要依赖的数据未改变，计算属性函数只会被调用一次；而方法被使用多少次就会被调用多少次</li>
<li>method在模板内使用需要显式的调用，而computed直接当成data的使用。</li>
</ul>
<h2 id="vue性能优化"><a href="#vue性能优化" class="headerlink" title="vue性能优化"></a>vue性能优化</h2><h3 id="编码优化"><a href="#编码优化" class="headerlink" title="编码优化"></a>编码优化</h3><ul>
<li>事件委托：使用事件委托能减少内存占用，减少不必要的重复代码。关于事件委托的介绍，可以参考<a href="https://www.sanye.blog/posts/aef189c3.html">前端面试—js部分 | 三叶的博客</a></li>
<li>保证key值唯一：有利于diff算法</li>
<li>组件缓存keep-alive：会缓存不活动的<strong>组件实例</strong>，而不是销毁它们，<strong>防止重复渲染DOM</strong>。</li>
</ul>
<h3 id="加载优化"><a href="#加载优化" class="headerlink" title="加载优化"></a>加载优化</h3><ul>
<li>路由懒加载（按需加载组件）</li>
<li>图片懒加载</li>
</ul>
<h2 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h2><p>model-view-viewmodel</p>
<h3 id="model"><a href="#model" class="headerlink" title="model"></a>model</h3><p>层负责管理应用程序的业务逻辑和数据，不包含任何的ui逻辑，类似小程序中的逻辑层</p>
<h3 id="view"><a href="#view" class="headerlink" title="view"></a>view</h3><p>View 负责显示数据给用户；是应用程序直接与用户直接交互的部分，类似小程序中的视图层</p>
<h3 id="viewmodel"><a href="#viewmodel" class="headerlink" title="viewmodel"></a>viewmodel</h3><p>ViewModel 作为 Model 和 View 之间的桥梁，负责将数据转换成view可以使用的格式。在vue中，这个桥梁（vm）就是vue实例。</p>
<h1 id="Vue3"><a href="#Vue3" class="headerlink" title="Vue3"></a>Vue3</h1><h2 id="setup（）"><a href="#setup（）" class="headerlink" title="setup（）"></a>setup（）</h2><ul>
<li><p>vue3中的一个新的<strong>配置项</strong>，值为一个函数，组合式api都写在这里面。</p>
</li>
<li><p>执行时机在<code>beforeCreate()</code>之前，也就是在组件创建之前执行代码；而before Create的执行时机又再data函数被调用前。</p>
</li>
<li><p>setup中不能使用this，<strong>this的值是undefined</strong>；</p>
</li>
<li><p>setup不能是async函数</p>
</li>
</ul>
<h3 id="在组合式api中的写法"><a href="#在组合式api中的写法" class="headerlink" title="在组合式api中的写法"></a>在组合式api中的写法</h3><p>在<code>组合式api</code>中，<code>setup()</code>以下面的方式书写，格式类似生命周期函数。</p>
<p>setup中准备的<code>数据</code>和<code>函数</code> 需要在setup最后<code>return</code>后，才能在模板中应用 。</p>
<p>配置了setup，还能配置<code>data</code>和<code>methods</code>，同时在methods里面也能读取到setup中的配置，当data中和setup中存在数据冲突，setup中的数据优先级更高，<strong>但是还是建议vue2的配置和vue3的配置不要混用</strong>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">setup</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">	  <span class="keyword">const</span> message = <span class="string">&#x27;hello Vue3&#x27;</span></span></span><br><span class="line"><span class="language-javascript">	  <span class="keyword">const</span> <span class="title function_">logMessage</span> = (<span class="params"></span>) =&gt;&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(message)&#125;</span></span><br><span class="line"><span class="language-javascript">	  <span class="keyword">return</span> &#123;message,logMessage&#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;<span class="attr">name</span>:<span class="string">&#x27;tom&#x27;</span>&#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">test</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">message</span>)</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">logMessage</span>)<span class="comment">//都可以访问到</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;beforeCreate函数&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其实还能返回一个<strong>渲染函数</strong>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123;h&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span><span class="comment">//在vue2中我们也接触过的渲染函数。</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span></span><br><span class="line"><span class="language-javascript">	<span class="title function_">setup</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">	  <span class="keyword">const</span> message = <span class="string">&#x27;hello Vue3&#x27;</span></span></span><br><span class="line"><span class="language-javascript">	  <span class="keyword">const</span> <span class="title function_">logMessage</span> = (<span class="params"></span>) =&gt;&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(message)&#125;</span></span><br><span class="line"><span class="language-javascript">	  <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="title function_">h</span>(<span class="string">&#x27;你好啊&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">	<span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;beforeCreate函数&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后这个<code>组件</code>就会使用这个函数来渲染，而<strong>忽略模板结构</strong>。</p>
<h3 id="语法糖写法"><a href="#语法糖写法" class="headerlink" title="语法糖写法"></a>语法糖写法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//独占一个script标签，不需要return</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> message = <span class="string">&#x27;this is a message&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">logMessage</span> = (<span class="params"></span>)=&gt;&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(message)&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="setup的参数"><a href="#setup的参数" class="headerlink" title="setup的参数"></a>setup的参数</h3><p>setup的参数在混合选项式api的时候，也就当不使用<code>setup语法糖</code>开发的时候是有意义的，使用语法糖开发的时候参数都没了。</p>
<p><code>setup(props,context)</code></p>
<h4 id="props"><a href="#props" class="headerlink" title="props"></a>props</h4><p>是第一个参数，值为对象，包含组件外部传入组件的，且在组件<strong>内部接收的值</strong>，也就是在<code>props属性</code>中接受的值。</p>
<p><strong>这个参数的作用就在于，让通过选项式语法中的props属性接收的值，能够在setup函数内部使用。</strong></p>
<p>这些属性是响应式的，因此当父组件更新 <code>props</code> 时，子组件中的 <code>props</code> 也会自动更新。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template)</span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>一个人的信息<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>姓名:&#123;&#123;person.name&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>年龄:&#123;&#123;person.age&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">	import &#123; reactive &#125; from &#x27;vue</span><br><span class="line">	export default &#123;</span><br><span class="line">		name: &#x27;Demo&#x27;</span><br><span class="line">		props:[&#x27;msg&#x27;,&#x27;school&#x27;],</span><br><span class="line">		setup(props)&#123;</span><br><span class="line">			console.log(&#x27;---setup---&#x27;,props)//输出Proxy&#123;msg:&#x27;你好啊&#x27;,school:&#x27;南昌大学&#x27;&#125;</span><br><span class="line">			//数据</span><br><span class="line">			let person = reactive(&#123;</span><br><span class="line">				name:&#x27;张三&#x27;</span><br><span class="line">				age:18</span><br><span class="line">			&#125;)</span><br><span class="line">			//返回一个对象(常用)</span><br><span class="line">			return &#123;person&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="context"><a href="#context" class="headerlink" title="context"></a>context</h4><p>第二个参数，上下文对象，包含多个属性</p>
<ul>
<li><p>attrs：值为对象，包含组件外部传入组件的，但在组件内部未被接收的值，因为这些值会被当成<strong>组件的属性</strong>，所以存储<code>context.attrs</code>中，类似vue2中的<code>this.$attrs</code>（用来获取组件实例的属性）</p>
</li>
<li><p>emit：值为函数，相当于<code>this.$emit</code>，用来触发<code>自定义事件</code></p>
<p>要注意的是，在vue3中，给组件添加的事件监听，默认都是<code>原生事件</code>，如果需要指定为<code>自定义事件</code>，需要在子组件中通过<code>emits</code>属性声明，或者使用组合式api中的<code>defineEmits(返回emit函数)</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.<span class="title function_">emit</span>(<span class="string">&#x27;hello&#x27;</span>,<span class="number">666</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>slots：收到的插槽内容，类似vue2中的<code>this.$slots</code>，可以访问到<code>父组件</code>通过<code>插槽</code>传递的所有内容。<code>this.$slots</code> 是一个对象，其键名对应于<code>插槽的名字</code>（对于默认插槽，键名为 <code>default</code>），值则是包含一组<code> VNode</code> 的数组。</p>
</li>
</ul>
<p>简单的来说，<strong>context参数弥补了在setup函数内部因为不能使用this而确实的部分功能</strong>，比如<code>this.$emit</code>可以被替换为<code>context.emit</code>，<code>this.$slot</code>可以被替换为<code>context.slots</code>。</p>
<h2 id="reactive和ref"><a href="#reactive和ref" class="headerlink" title="reactive和ref"></a>reactive和ref</h2><p>vue3中数据默认不是响应式的，需要手动添加响应式。</p>
<h3 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a>reactive</h3><ul>
<li>接受<code>对象类型</code>数据的参数，并返回一个<code>响应式</code>的对象，就是Proxy类型的对象。</li>
<li>传入一个源对象，经过proxy操作返回一个代理对象，修改代理对象会映射到源对象。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript">	<span class="comment">//执行函数传入参数变量接收</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> state = <span class="title function_">reactive</span>(对象类型数据)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>源码分析：</strong></p>
<p>修改代理对象会映射到源对象这一点，在传入的第一个参数：配置对象上就能看出，操作对象一直是target。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reactive</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="comment">// 如果目标已经是响应式的，则直接返回</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isReactive</span>(target)) &#123;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//关于proxy的介绍，可参考本博客中前端面试-vue一文</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(target, &#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params">target, key, receiver</span>) &#123;</span><br><span class="line">      <span class="comment">//收集依赖</span></span><br><span class="line">      <span class="title function_">track</span>(target, key);</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, key, receiver);</span><br><span class="line">      <span class="comment">//这说明proxy类型的响应式数据是在系统被取出的时候才递归的添加响应式的，这种方式叫做懒递归或者按需递归添加响应式</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isObject</span>(result) ? <span class="title function_">reactive</span>(result) : result;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">target, key, value, receiver</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> oldValue = target[key];</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, key, value, receiver);</span><br><span class="line">      <span class="keyword">if</span> (oldValue !== value) &#123;</span><br><span class="line">        <span class="comment">//通知依赖更新</span></span><br><span class="line">        <span class="title function_">trigger</span>(target, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">deleteProperty</span>(<span class="params">target, key</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> hadKey = <span class="title function_">hasOwn</span>(target, key);</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">deleteProperty</span>(target, key);</span><br><span class="line">      <span class="keyword">if</span> (hadKey) &#123;</span><br><span class="line">        <span class="comment">//通知依赖更新</span></span><br><span class="line">        <span class="title function_">trigger</span>(target, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><ul>
<li><p>接受<code>简单类型</code>或者<code>复杂类型数据</code>，返回一个<code>响应式对象</code>，就是<code>RefImpl</code>类型的对象，如果传入的值是对象，那<code>ref.value</code>的类型就是proxy。</p>
</li>
<li><p>ref在内部其实会使用<code>reactive</code>(如果传入的是一个对象)，总的来说基于<code>proxy</code>实现。</p>
</li>
<li><p>实例结构分析：</p>
<p>下面三个属性是并列关系</p>
<ul>
<li><p><code>value</code>：不可枚举属性，访问实际是在调用<code>get函数</code>，返回<code>_value</code>中的数据。</p>
</li>
<li><p><code>_value</code>：访问value返回的实际数据</p>
</li>
<li><p><code>_rawValue</code>：源数据，传入ref的<code>原始数据</code>，<code>raw</code>的中文意思就是”未经加工的，原始的”；当原始数据是简单类型，<code>_rawValue</code>等于<code>_value</code>，当传入的是对象，<code>_rawValue</code>的值始终是对象，<code>_value</code>的值则是<code>proxy</code>对象，修改<code>_value</code>会映射到<code>_rawValue</code>上。</p>
</li>
</ul>
</li>
</ul>
<img src="..\images\vue\ref.png" style="zoom:90%;" />

<img src="..\images\vue\ref2.png" style="zoom:90%;" />

<p>至于<code>value</code>属性对应的<code>getter，setter</code>，存在于<code>[[prototype]]</code>对象中。</p>
<p>大致源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ref</span>(<span class="params">val</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RefImpl</span>(val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RefImpl</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">value, __v_isShallow</span>) &#123;</span><br><span class="line">    <span class="comment">//表示是否为浅层响应式，默认为false，如果为 true，则不会递归地将嵌套的对象或数组转换为响应式对象。</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__v_isShallow</span> = __v_isShallow;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dep</span> = <span class="keyword">void</span> <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__v_isRef</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//存储原始值</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_rawValue</span> = __v_isShallow ? value : <span class="title function_">toRaw</span>(value);<span class="comment">//默认取第二个值</span></span><br><span class="line">    <span class="comment">//在这行代码可以看出ref和reactive密不可分的关系</span></span><br><span class="line">    <span class="comment">//toReactive方法内部很可能会判断value是不是对象，如果是就会调用reactive包装。由此也可以看出ref和reactive之间的联系</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_value</span> = __v_isShallow ? value : <span class="title function_">toReactive</span>(value);<span class="comment">//默认取第二个值</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="title function_">trackRefValue</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="comment">//返回的是_value，也就是说其实value取的值就是_value</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">value</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> useDirectValue = <span class="variable language_">this</span>.<span class="property">__v_isShallow</span> || <span class="title function_">isShallow</span>(newVal) || <span class="title function_">isReadonly</span>(newVal);</span><br><span class="line">    newVal = useDirectValue ? newVal : <span class="title function_">toRaw</span>(newVal);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">hasChanged</span>(newVal, <span class="variable language_">this</span>.<span class="property">_rawValue</span>)) &#123;</span><br><span class="line">      <span class="keyword">const</span> oldVal = <span class="variable language_">this</span>.<span class="property">_rawValue</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_rawValue</span> = newVal;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_value</span> = useDirectValue ? newVal : <span class="title function_">toReactive</span>(newVal);<span class="comment">//重新创建一个响应式对象</span></span><br><span class="line">      <span class="title function_">triggerRefValue</span>(<span class="variable language_">this</span>, <span class="number">4</span>, newVal, oldVal);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以观察到，构造函数中并没有初始化<code>value</code>，但是<code>refImpl</code>实例中出现了，我自己测试了一下，发现并没有借助defineProperty：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义一个refImpl类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">refImpl</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_value</span> = value</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> <span class="title function_">value</span>(<span class="params">val</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_value</span> = val</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title function_">refImpl</span>(<span class="number">123</span>)</span><br></pre></td></tr></table></figure>

<p>最后打印p的结构如图：</p>
<img src="..\images\vue\ref4.png" style="zoom:90%;" />

<p>观察到，value属性出现了。</p>
<p><strong>注意</strong>：</p>
<ul>
<li><p>当我们直接给<code>.value</code>赋予一个新的对象，vue会帮我们 <code>重新</code>创建一个响应式对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">_rawValue</span> = newVal;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_value</span> = useDirectValue ? newVal : <span class="title function_">toReactive</span>(newVal);<span class="comment">//重新创建一个响应式对象</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>脚本中访问ref数据，需要通过<code>.value</code>，而在<code>template</code>中， <code>.value</code>不需要加（帮我们扒了一层)，就好比在vue2的模板内，可以省略this，比如<code>this.$store</code>在模板内直接写为<code>$store</code>，其实data中的数据能直接在模板中使用，也是省略了this。</p>
</li>
</ul>
<h2 id="toRef-和toRefs"><a href="#toRef-和toRefs" class="headerlink" title="toRef()和toRefs()"></a>toRef()和toRefs()</h2><h3 id="响应式丢失"><a href="#响应式丢失" class="headerlink" title="响应式丢失"></a>响应式丢失</h3><p>下面举个例子来说明：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;txt.num++&quot;</span>&gt;</span>num++<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;console.log(++age)&quot;</span>&gt;</span>age++<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; obj &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; txt &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; age &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; reactive, toRef, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> obj = <span class="title function_">ref</span>(&#123; <span class="attr">txt</span>: &#123; <span class="attr">num</span>: <span class="number">1</span> &#125;, <span class="attr">age</span>: <span class="number">12</span> &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> txt = obj.<span class="property">value</span>.<span class="property">txt</span><span class="comment">//触发getter</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(txt)<span class="comment">//输出Proxy(Object) &#123;num: 1&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> age = obj.<span class="property">value</span>.<span class="property">age</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(age)<span class="comment">//输出12</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们点击<code>num++</code>，发现视图中的<code>obj</code>和<code>txt</code>都被更新了，输出<code>txt</code>发现是个<code>Proxy</code>类型的对象，说明<code>响应式</code>并没有丢失。</p>
<p>我们点击<code>age++</code>，发现视图中的<code>age</code>并没有随之改变，输出<code>age</code>，发现是简单数据类型，说明响应式丢失了。</p>
<p>因此我们可以得出，vue3是<code>递归</code>给对象添加响应式的（其实是需要的时候再递归添加），解构对象并<strong>不是所有属性</strong>的响应式都会丢失。</p>
<p>虽然我们对<code>ref</code>和<code>reactive</code>已经比较了解了，为了保险起见，我们将<code>ref</code>替换为<code>reactive</code>再测试一下，果然，现象完全一样。</p>
<p>其实在<code>vue2</code>中，也存在着响应式丢失的现象，我们知道vue2是响应式实现是基于<code>Object.defineProperty</code>方法的，当vue2给一个对象添加响应式，如果这个对象中还包含对象，则<strong>也会递归添加响应式</strong>。下面是一个例子来说明这一点：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">obj</span>:&#123;<span class="attr">a</span>:<span class="string">&#x27;tom&#x27;</span>, <span class="attr">child</span>: &#123;<span class="attr">b</span>:<span class="string">&#x27;cindy&#x27;</span>&#125;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">obj</span>.<span class="property">a</span>,<span class="variable language_">this</span>.<span class="property">obj</span>.<span class="property">child</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码会输出<code>&#39;tom&#39;</code>和一个<strong>响应式对象child</strong>:</p>
<img src="..\images\vue\丢失响应.png" style="zoom:90%;" />



<h3 id="toRef"><a href="#toRef" class="headerlink" title="toRef()"></a>toRef()</h3><p><code>toRef()</code> 函数可以将一个响应式对象(ref或者reactive包装的对象)的某个属性转换成一个<code>ObjectRefImpl</code>（注意是<strong>返回一个新的ObjectRefImpl对象，并不会修改任何对象</strong>），从而解决对象解构响应式丢失的问题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, toRef, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> b = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">price</span>: <span class="number">20</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> countRef = <span class="title function_">toRef</span>(a, <span class="string">&#x27;count&#x27;</span>);</span><br><span class="line"><span class="comment">//const priceRef = toRef(b.value, &#x27;price&#x27;);这里一定要加value</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改countRef 同时会更新a.count</span></span><br><span class="line">countRef.<span class="property">value</span>++;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">count</span>); <span class="comment">// 输出: 1</span></span><br><span class="line"><span class="comment">// 修改 a.count 同时会更新countRef</span></span><br><span class="line">a.<span class="property">count</span>++;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(countRef.<span class="property">value</span>); <span class="comment">// 输出: 2</span></span><br></pre></td></tr></table></figure>

<p><code>a.count</code>和<code>countRef</code>的共用一份源数据。输出<code>countRef</code>：</p>
<img src="..\images\vue\toRef.png" style="zoom: 80%;" />



<p>其中<code>_object</code>参数<code>toRef</code>传入的第一个参数，<code>_key</code>就是<code>toRef</code>传入的第二个参数，当我们访问value的时候，返回的就是<code>_object[_key]</code>，当我们修改value的时候，其实就是在修改<code>_object[_key]</code>，而<code>_object</code>本身就是一个代理对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="keyword">const</span> val = <span class="variable language_">this</span>.<span class="property">_object</span>[<span class="variable language_">this</span>.<span class="property">_key</span>];</span><br><span class="line">    <span class="keyword">return</span> val === <span class="keyword">void</span> <span class="number">0</span> ? <span class="variable language_">this</span>.<span class="property">_defaultValue</span> : val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">set</span> <span class="title function_">value</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_object</span>[<span class="variable language_">this</span>.<span class="property">_key</span>] = newVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs()"></a>toRefs()</h3><p><code>toRefs()</code> 函数可以将整个响应式对象的所有属性都转换为<code>refs</code> 的集合。这对于解构响应式对象特别有用，因为直接解构会导致某些属性<strong>丢失响应性</strong>。直接解构就等同于<strong>取值</strong>然后<strong>赋值给新的变量</strong>，我们取值取的数据<code>来源</code>就是<code>源对象</code>，而源对象中的部分属性值<code>不具有响应式</code>的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, toRefs &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">  <span class="attr">version</span>: <span class="number">3</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//返回一个新的对象，不修改源对象</span></span><br><span class="line"><span class="keyword">const</span> stateAsRefs = <span class="title function_">toRefs</span>(state);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stateAsRefs)</span><br><span class="line"><span class="comment">// 解构赋值，同时保持响应性</span></span><br><span class="line"><span class="keyword">const</span> &#123; name, version &#125; = stateAsRefs;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改 name 或 version 同时会更新 state 中对应的属性</span></span><br><span class="line">name.<span class="property">value</span> = <span class="string">&#x27;Vue.js&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">name</span>); <span class="comment">// 输出: Vue.js</span></span><br><span class="line"></span><br><span class="line">version.<span class="property">value</span> = <span class="number">3.0</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">version</span>); <span class="comment">// 输出: 3.0</span></span><br></pre></td></tr></table></figure>

<p>可以看出<code>stateAsRefs</code>对象就是一个普通的对象，不过它的每个属性的值都变成了<code>ObjectRefImpl</code>类型的数据。</p>
<img src="..\images\vue\toRefs.png" style="zoom:80%;" />

<h2 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="title function_">computed</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span>计算返回的结果</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<ul>
<li>vue3中的computed属性默认是响应式的</li>
<li>避免直接修改计算属性的值，计算属性应该是只读的，特殊情况可以配置get，set</li>
<li>计算属性中不应该有<code>副作用</code>，不建议在计算属性中写dom操作和异步请求</li>
</ul>
<p><strong>与vue2计算属性区别：</strong></p>
<ul>
<li>vue2使用computed不需要导入，是一个配置属性；vue3中的computed是一个函数，需要按需导入。</li>
<li>vue2中<code>批量添加</code>计算属性更方便，在vue3中每次获得一个计算属性都要传入一个回调函数，调用一次<code>computed</code>函数</li>
</ul>
<h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><p>vue3中的事件监听有蛮多问题的，不太好学。</p>
<p>watch能正常监听通过<code>ref(基本类型数据)</code>得到的对象的改变，比如<code>ref(0)</code>；但是监听不到<code>ref(引用类型数据)</code>得到的对象的改变，比如<code>ref(&#123; age: 0 &#125;)</code>，虽然这个问题可以通过开启<strong>深度监听</strong>解决（在第三个参数传入<code>&#123; deep: true &#125;</code>），但是存在新旧数据相同的问题。</p>
<p>watch监听reactive类型的数据默认是<code>深度监听</code>，也存在新旧数据相同的问题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  &#123; watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//语法--监听一个ref对象</span></span><br><span class="line"><span class="title function_">watch</span>(ref对象,（newValue, oldValue) =&gt;&#123; ... &#125;)<span class="comment">//第一个数据是要监听的数据</span></span><br><span class="line"><span class="comment">//语法--监听多个ref对象</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">    <span class="comment">//通过数组叠加多个监听对象</span></span><br><span class="line">	[count,name],</span><br><span class="line">    <span class="comment">//newVal和oldVal是数组</span></span><br><span class="line">	<span class="function">(<span class="params">newVal,oldVal</span>)=&gt;</span> &#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;count或者name变化了&#x27;</span>,newVal,oldVal)</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">//精确监听reactive对象的某个属性                                    </span></span><br><span class="line"><span class="comment">//传入一个回调函数，非常不人性                                    </span></span><br><span class="line"><span class="title function_">watch</span>(<span class="function">() =&gt;</span>userInfo.<span class="property">value</span>.<span class="property">age</span>, <span class="function">(<span class="params">newValue，oldValue</span>)=&gt;</span>&#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(newValue,oldValue) &#125; )</span><br></pre></td></tr></table></figure>

<p><strong>与vue2中watch的区别</strong></p>
<ul>
<li>vue2中watch是属性，vue3中是需要导入的函数</li>
<li>在vue2的watch中的函数名就是监听的对象，执行的操作是函数体</li>
<li>vue2中添加多个监听对象只需要都写在watch:{}中就行，vue3中可以放在数组中整体监听</li>
</ul>
<h2 id="生命周期函数"><a href="#生命周期函数" class="headerlink" title="生命周期函数"></a>生命周期函数</h2><p>在vue3中，既支持<code>选项式</code>生命周期函数，也支持<code>组合式</code>生命周期函数。</p>
<h3 id="选项式"><a href="#选项式" class="headerlink" title="选项式"></a><strong>选项式</strong></h3><ol>
<li><code>beforeCreate</code>：实例初始化之后，数据观测 (data observer) 和 event&#x2F;watcher 事件配置之前被调用。</li>
<li><code>created</code>：实例创建完成后被调用。此时已完成数据观测 (data observer)，属性和方法的运算，watch&#x2F;event 事件回调。但是尚未挂载，<code>$el</code> 属性目前不可见。</li>
<li><code>beforeMount</code>：在挂载开始之前被调用，相关的 <code>render</code> 函数首次被调用。</li>
<li><code>mounted</code>：实例挂载到 DOM 后调用，这时 <code>el</code> 被新创建的 <code>vm.$el</code> 替换，并挂载到实例上。注意，不能保证它在整个组件树完全渲染完成时才调用。</li>
<li><code>beforeUpdate</code>：在数据更新导致虚拟 DOM 重新渲染和打补丁之前调用。你可以在这个钩子中进一步地更改状态，这不会触发附加的重渲染过程。</li>
<li><code>updated</code>：由于数据更改导致的虚拟 DOM 重新渲染和打补丁，在这之后会调用该钩子。当这个钩子被调用时，组件 DOM 已经更新，所以你现在可以执行依赖于 DOM 的操作。</li>
<li><code>beforeUnmount</code>（在 Vue 2 中称为 <code>beforeDestroy</code>）：在卸载组件实例之前调用。在这个阶段，实例仍然是完全正常的。</li>
<li><code>unmounted</code>（在 Vue 2 中称为 <code>destroyed</code>）：卸载组件后调用。调用此钩子时，组件实例的所有指令都被解绑，所有事件监听器都被移除，所有子组件实例也都会被销毁。</li>
</ol>
<p>简单的来说，vue3的选项式生命周期函数与vue2的生命周期函数的区别仅仅在于最后两个。</p>
<h3 id="组合式"><a href="#组合式" class="headerlink" title="组合式"></a><strong>组合式</strong></h3><p>在 Vue 3 的组合式 API 中，你可以使用 <code>onXXX</code> 形式的函数来注册生命周期钩子。这些函数可以直接在 <code>setup()</code> 函数或 <code>&lt;script setup&gt;</code> 中使用。</p>
<ul>
<li><code>onBeforeMount</code></li>
<li><code>onMounted</code></li>
<li><code>onBeforeUpdate</code></li>
<li><code>onUpdated</code></li>
<li><code>onBeforeUnmount</code></li>
<li><code>onUnmounted</code></li>
</ul>
<p> Vue 3 中，<code>setup</code> <strong>函数</strong>涵盖了 <code>beforeCreate</code> 和 <code>created</code> <strong>钩子</strong>的功能，因此不再需要这两个钩子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onMounted, onUpdated, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 这里相当于 beforeCreate 和 created 的合并作用域</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Setup function: Initialization logic here.&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Component is mounted!&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onUpdated</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Component has been updated!&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Component has been unmounted.&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h2><h3 id="props与emit"><a href="#props与emit" class="headerlink" title="props与emit"></a>props与emit</h3><h4 id="父传子"><a href="#父传子" class="headerlink" title="父传子"></a>父传子</h4><p>父组件给子组件，添加属性的方式传值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">sonComVue</span> <span class="attr">:message</span>=<span class="string">&quot;message&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在子组件，通过props接收，借助于<code>编译器宏</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用编译器宏不需要导入</span></span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>,</span><br><span class="line">&#125;)<span class="comment">//defineProps返回一个对象，对象内部的数据可以直接在模板内使用，在script标签中则需要通过props（返回的对象）访问</span></span><br></pre></td></tr></table></figure>

<h4 id="子传父"><a href="#子传父" class="headerlink" title="子传父"></a>子传父</h4><p>父组件中给子组件标签通过<code>@</code>绑定事件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--绑定自定义事件--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">sonComVue</span> <span class="attr">:message</span>=<span class="string">&quot;message&quot;</span> @<span class="attr">get-message</span>=<span class="string">&quot;getMessage&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>子组件内部通过<code>emit</code>方法触发事件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">	  <span class="attr">message</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;get-message&#x27;</span>])<span class="comment">//指定哪些事件是自定事件，并返回emit方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">sendMsg</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">emit</span>(<span class="string">&#x27;get-message&#x27;</span>, <span class="string">&#x27;this is son msg&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其实用<code>v-model</code>也能实现。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">sonComVue</span> <span class="attr">v-model:message</span>=<span class="string">&quot;message&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">	  <span class="attr">message</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;update:message&#x27;</span>])<span class="comment">//指定哪些事件是自定事件，并返回emit方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">sendMsg</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">emit</span>(<span class="string">&#x27;update:message&#x27;</span>, <span class="string">&#x27;this is son msg&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="与vue2的区别"><a href="#与vue2的区别" class="headerlink" title="与vue2的区别"></a>与vue2的区别</h4><ul>
<li>无法直接通过this调用<code>$emit</code>函数，需要通过编译器宏获得emit函数。</li>
<li>在vue2中可以通过<code>&lt;component @click.native&gt;&lt;/component&gt;</code>，表示添加的点击事件是原生事件，而不是自定义事件；在vue3中这种写法被移除了，给组件添加的事件默认是原生的。</li>
</ul>
<h3 id="provide与reject"><a href="#provide与reject" class="headerlink" title="provide与reject"></a>provide与reject</h3><p>顶层通过<code>provide</code>提供数据，底层通过<code>inject</code>接收数据，数据传递是单向的</p>
<h4 id="provide"><a href="#provide" class="headerlink" title="provide"></a>provide</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; provide, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="title function_">ref</span>(<span class="string">&#x27;John Doe&#x27;</span>);</span><br><span class="line">    <span class="title function_">provide</span>(<span class="string">&#x27;user&#x27;</span>, user); <span class="comment">// 提供一个响应式的 user,并把它命名为user</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 返回其他需要暴露给模板的内容</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="inject"><a href="#inject" class="headerlink" title="inject"></a>inject</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//返回值就是祖先组件提供的值，如果没有找到 &#x27;user&#x27;，则使用默认值</span></span><br><span class="line">    <span class="keyword">const</span> user = <span class="title function_">inject</span>(<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;Default User&#x27;</span>); <span class="comment">//</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      user</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="响应式"><a href="#响应式" class="headerlink" title="响应式"></a>响应式</h4><p>当使用 <code>provide</code> 提供的数据是响应式的（例如通过 <code>ref</code> 或 <code>reactive</code> 创建），那么在数据更新时，所有通过 <code>inject</code> 接收到该数据的组件都会<code>自动更新</code>。这是因为 <code>provide</code>&#x2F;<code>inject</code> 维护的是对原始数据的引用，我们认为这些组件<strong>依赖</strong>这些注入的数据。</p>
<h4 id="与vue2的区别-1"><a href="#与vue2的区别-1" class="headerlink" title="与vue2的区别"></a>与vue2的区别</h4><ul>
<li><p>vue2中可以通过<code>inject:[]</code>来批量接收数据，vue3中只能一个一个接收。</p>
</li>
<li><p>vue2中可以在<code>provide()&#123; return&#123;//传递的数据，格式，键：值&#125;&#125;</code>中批量传递数据，vue3中只能一个一个的传递数据</p>
</li>
<li><p>vue2中无论传递（provide）的数据是data或者computed中的数据，还是其他数据，注入子组件中后都不是响应式的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    num:&#123;&#123;num&#125;&#125;age:&#123;&#123;age&#125;&#125;</span><br><span class="line">    &lt;button @click=&quot;add(&#x27;num&#x27;)&quot;&gt;num++&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;add(&#x27;age&#x27;)&quot;&gt;age++&lt;/button&gt;//点击num++子组件视图不更新，点击age++，子组件视图更新</span><br><span class="line">    &lt;HelloWorld :age=&quot;age&quot;&gt;&lt;/HelloWorld&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import HelloWorld from &#x27;@/components/HelloWorld.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      num:1,</span><br><span class="line">      age:20</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  provide()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      num:this.num</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components:&#123;</span><br><span class="line">    HelloWorld</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    add(str)&#123;</span><br><span class="line">      if(str==&#x27;num&#x27;)&#123;</span><br><span class="line">        this.num++</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        this.age++</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;hello&quot;&gt;</span><br><span class="line">    num:&#123;&#123;num&#125;&#125;age:&#123;&#123;age&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;HelloWorld&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    age: Number</span><br><span class="line">  &#125;,</span><br><span class="line">  inject:[&#x27;num&#x27;]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="模板引用"><a href="#模板引用" class="headerlink" title="模板引用"></a>模板引用</h2><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ul>
<li>调用ref函数生成一个ref对象:<code>const inp = ref(null)</code></li>
<li>通过ref标识，进行绑定<code>&lt;input ref=&quot;inp&quot; type=&quot;text&quot;&gt;</code></li>
<li>通过<code>ref对象.value</code>即可访问到绑定的元素</li>
</ul>
<h3 id="与vue2中ref-ref的区别与联系"><a href="#与vue2中ref-ref的区别与联系" class="headerlink" title="与vue2中ref&#x2F;$ref的区别与联系"></a>与vue2中ref&#x2F;$ref的区别与联系</h3><ul>
<li>vue2中通过给<code>子元素</code>添加<code>ref属性</code>并任意赋值命名，然后通过<code>this.$ref.属性名</code>就能获取到绑定的dom或者组件实例</li>
<li>总的来说，都是给dom元素或者组件添加<strong>ref属性</strong>，然后赋一个值；在vue2中这个值是一个独一无二的名字，在vue3中这个值就是一个<code>RefImpl</code>类型的数据；然后都要拿到dom元素或者组件实例，在vue2中是通过<code>this.$ref.属性名</code>拿到，在vue3中是通过<code>RefImpl.value</code>拿到</li>
<li>作用范围都是当前组件内</li>
</ul>
<h2 id="defineExpose"><a href="#defineExpose" class="headerlink" title="defineExpose()"></a>defineExpose()</h2><p>默认情况下在<code>&lt;script setup&gt;</code>语法糖下，<strong>组件内部的属性和方法是不开放给父组件访问的</strong>，即便能够拿到组件实例也访问不了。</p>
<p>可以通过<code>defineExpose</code>编译宏指定哪些属性和方法允许访问</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> count = <span class="number">999</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> <span class="title function_">sayHi</span> = (<span class="params"> </span>)=&gt;&#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;打招呼&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript">	<span class="title function_">defineExpose</span>(&#123;count,sayHi&#125;)<span class="comment">//暴露给父组件</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>而在vue2中，只要获取到了组件对象，就能访问里面的属性（data）和方法(methods)。</p>
<h1 id="Vue-Router"><a href="#Vue-Router" class="headerlink" title="Vue-Router"></a>Vue-Router</h1><p>在vue2，vue3项目，使用的路由插件都是<code>vue-router</code>，就是语法有所不同。</p>
<p>修改地址栏路径时，切换显示匹配的组件</p>
<h2 id="单页面应用"><a href="#单页面应用" class="headerlink" title="单页面应用"></a>单页面应用</h2><p>所有功能在一个html页面上实现，基于前端路由实现</p>
<p>优点：按需更新性能高，开发效率高，用户体验好</p>
<p>缺点：学习成本，首屏加载慢（如果不使用代码分割，加载首屏还会将其他页面的资源一同加载并处理，然后才开始首屏渲染），还不利于SEO。</p>
<h2 id="路由导航"><a href="#路由导航" class="headerlink" title="路由导航"></a>路由导航</h2><h3 id="声明式导航router-link"><a href="#声明式导航router-link" class="headerlink" title="声明式导航router-link"></a>声明式导航router-link</h3><p>使用vue-router提供的<strong>全局组件</strong><code>router-link</code>，替代a标签实现跳转，必须配置to属性指定路径（不需要加＃）。本质还是a标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/路径值&quot;</span>&lt;/<span class="attr">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>能高亮，默认就会提供<strong>高亮类名</strong>，可以直接设置高亮样式，不需要手动添加类名，高亮类名包括：</p>
<ul>
<li><p>router-link-active（模糊匹配，常用）</p>
<p><code>to=&quot;/my&quot;</code>可以匹配<code>/my/b</code>，意思是当前页面的前端路由是<code>/my/b</code>，这个高亮类名就会生效。</p>
</li>
<li><p>router-link-exact-active（精确匹配）：就必须完全一样，这个高亮类名才会生效。</p>
</li>
</ul>
<h3 id="编程式导航"><a href="#编程式导航" class="headerlink" title="编程式导航"></a>编程式导航</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>()</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>使用path跳转</strong></p>
<ul>
<li><p>push字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">&#x27;路由路径&#x27;</span>)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">&#x27;/路径?参数名1=参数值1&amp;参数2=参数值2&#x27;</span>)<span class="comment">//传入查询参数</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">&#x27;/路径/参数值&#x27;</span>)<span class="comment">//动态路由传参</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>push对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">path</span>: <span class="string">&#x27;路由路径&#x27;</span>&#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">	<span class="attr">path</span>: <span class="string">&#x27;/路径&#x27;</span>,</span><br><span class="line">	<span class="attr">query</span>: &#123;参数名<span class="number">1</span>:<span class="string">&#x27;参数值1&#x27;</span>,参数名<span class="number">2</span>:<span class="string">&#x27;参数值2&#x27;</span>&#125;</span><br><span class="line">&#125;)<span class="comment">//传入查询参数</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">path</span>:<span class="string">&#x27;/路径&#x27;</span>, <span class="attr">params</span>:&#123;参数名:参数值&#125;&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>使用name跳转</p>
<p>适合路径过长的路由，给path路径取名，用name替代path，好处是不用写过长的路径，缺点是只能通过<strong>push对象</strong>的方式跳转，传参，因为没有path无法拼接成合法的url。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>, <span class="comment">// 给首页路由命名为 &#x27;Home&#x27;</span></span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>, <span class="comment">// 给关于页面路由命名为 &#x27;About&#x27;</span></span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 其他路由...</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&quot;路由名字&#x27;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">this.$router.push(&#123;</span></span><br><span class="line"><span class="string">	name:&quot;</span>路由名字<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">	query: &#123;参数名1:&#x27;</span>参数值<span class="number">1</span><span class="string">&#x27;,参数名2:&#x27;</span>参数值<span class="number">2</span><span class="string">&#x27;&#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">this.$router.push(&#123;</span></span><br><span class="line"><span class="string">	name:&quot;路由名字&#x27;</span>，</span><br><span class="line">	<span class="attr">params</span>: &#123;参数名<span class="number">1</span>:<span class="string">&#x27;参数值1&#x27;</span>,参数名<span class="number">2</span>:<span class="string">&#x27;参数值2&#x27;</span>&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="参数接受"><a href="#参数接受" class="headerlink" title="参数接受"></a>参数接受</h3><ul>
<li><p>this.$route.query：接收查询参数</p>
</li>
<li><p>this.$route.params：接收动态参数</p>
<p>动态路由传参的前提是<strong>组件配置了动态参数</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about/:a&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 其他路由...</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>然后跳转传参：<code>to=&quot;/about/3&quot;</code>，3就会被赋值给a，然后在About组件中，通过<code>this.$route.params.a</code>访问。</p>
<p>如果跳转不穿参：<code>to=&quot;/about&quot;</code>，就会报错，如果希望<strong>可传参，可不传</strong>，则在动态参数后加上<code>?</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about/:a?&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 其他路由...</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>动态路由的其他意义：让不同的路由对应相同的组件。</p>
</li>
</ul>
<h3 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h3><p><code>children</code> 属性用于定义嵌套路由。每个子路由的 <code>path</code> 应该<strong>相对于其父路由</strong>的路径来理解。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">      <span class="attr">children</span>: [</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&#x27;article&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Article</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&#x27;collect&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Collect</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&#x27;like&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Like</span> &#125;,</span><br><span class="line">      ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="重定向redirect"><a href="#重定向redirect" class="headerlink" title="重定向redirect"></a>重定向redirect</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: layout,</span><br><span class="line">    <span class="comment">//children 属性用于定义嵌套路由</span></span><br><span class="line">    <span class="attr">children</span>:[&#123; <span class="attr">path</span>: <span class="string">&#x27;home&#x27;</span>, <span class="attr">component</span>: home &#125;],</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/home&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 其他路由...</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h2 id="路由出口router-view"><a href="#路由出口router-view" class="headerlink" title="路由出口router-view"></a>路由出口router-view</h2><p><code>router-view</code>是vue-router提供的一个全局的组件，是一个可以被替换掉的<code>动态组件</code>。</p>
<h2 id="导航守卫"><a href="#导航守卫" class="headerlink" title="导航守卫"></a>导航守卫</h2><img src="..\images\vue\导航守卫.png" style="zoom:67%;" />

<h3 id="next"><a href="#next" class="headerlink" title="next()"></a>next()</h3><ul>
<li><strong>无参数</strong>：直接调用 <code>next()</code> 表示允许导航继续进行。</li>
<li><strong>传递路径或命名路由</strong>：<code>next(&#39;/somePath&#39;)</code> 或 <code>next(&#123; name: &#39;SomeRoute&#39; &#125;)</code> 用于重定向到另一个位置。</li>
<li>**传递 <code>false</code>**：<code>next(false)</code>阻止导航继续进行。</li>
<li><strong>传递错误对象</strong>：<code>next(error)</code> 触发路由错误处理逻辑。</li>
</ul>
<h3 id="局部守卫"><a href="#局部守卫" class="headerlink" title="局部守卫"></a>局部守卫</h3><ul>
<li><p><strong>组件内部</strong></p>
<ul>
<li><p>beforeRouteEnter</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">beforeRouteEnter</span>(<span class="params">to, <span class="keyword">from</span>, next</span>) &#123;</span><br><span class="line">    <span class="comment">// 在渲染该组件的对应路由被confirm 前调用</span></span><br><span class="line">    <span class="comment">// 不能获取组件实例 `this`，因为当守卫执行前，组件实例还没被创建</span></span><br><span class="line">    <span class="title function_">next</span>(<span class="function"><span class="params">vm</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 通过 `vm` 访问组件实例</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>beforeRouteLeave</p>
<p>这个守卫用来<strong>阻止用户离开当前路由</strong>。比如，你可以用它来提示用户是否有<code>未保存的更改</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">beforeRouteLeave</span>(<span class="params">to, <span class="keyword">from</span>, next</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> answer = <span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&#x27;Do you really want to leave? you have unsaved changes!&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (answer) &#123;</span><br><span class="line">      <span class="title function_">next</span>()<span class="comment">//确认离开</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="literal">false</span>)<span class="comment">//取消离开</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个功能类似<code>beforeunload</code> 事件，这个事件可以在用户即将离开页面时触发。这包括关闭窗口、刷新页面、导航到其他页面等操作。你可以使用这个事件来显示一个确认对话框给用户，询问他们是否真的要离开页面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;beforeunload&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="comment">// 设置返回值以显示确认对话框</span></span><br><span class="line">    event.<span class="property">returnValue</span> = <span class="string">&#x27;您确定要离开此页面吗？&#x27;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>beforeRouteUpdate</p>
<p>这个守卫在<strong>当前路由改变，但是该组件被复用时</strong>调用。举例来说，对于一个带有<strong>动态路由参数</strong>的路径 <code>/foo/:id</code>，当你从 <code>/foo/1</code> 导航到 <code>/foo/2</code> 时，由于会使用同一个组件实例，所以 <code>beforeRouteUpdate</code> 守卫会在这种情况下被调用。</p>
<p>但是如果这个组件实例被缓存了，从别的组件切换到这个组件也不会触发这个钩子。只能借助<code>activated</code>或者<code>beforeRouteEnter</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">beforeRouteUpdate</span>(<span class="params">to, <span class="keyword">from</span>, next</span>) &#123;</span><br><span class="line">    <span class="comment">// 路由改变时重新获取数据</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">//获取数据的逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以观察到组件内的路由守卫都以<code>beforeRoute</code>为前缀，而全局前置守卫和路由独享守卫都只以<code>before</code>为前缀</p>
</li>
</ul>
</li>
<li><p>路由独享守卫beforeEnter</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">   <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>, </span><br><span class="line">   <span class="attr">component</span>: home,</span><br><span class="line">   <span class="attr">beforeEnter</span>:<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(to,<span class="keyword">from</span>,next)</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">   &#125; </span><br><span class="line">&#125;,<span class="comment">//这里的to显然是home组件的路由对象，即this.$route</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="全局守卫"><a href="#全局守卫" class="headerlink" title="全局守卫"></a>全局守卫</h3><ul>
<li><p>beforeEach</p>
<p><code>beforeEach</code> 即<strong>全局前置守卫</strong>，在每次导航时都会触发，无论是从一个路由跳转到另一个路由，还是首次进入应用。所有的路由在真正被访问到之前(解析渲染对应组件页面前)，都会先经过<strong>全局前置守卫</strong>，只有全局前置守卫放行了，才会到达对应的页面，或者说才会开始渲染对应的组件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//next()表示放行，next(&quot;url&quot;)表示拦截到url</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//前两个是对象(和$route一样  是一个反应式的对象(路由对象))，后一个是函数</span></span><br><span class="line">  <span class="comment">//如果要访问的网站to对象的路径：path 不是&#x27;/pay&#x27;, &#x27;/myorder&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (!paths.<span class="title function_">includes</span>(to.<span class="property">path</span>)) &#123;</span><br><span class="line">    <span class="title function_">next</span>()<span class="comment">//放行</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">      <span class="title function_">next</span>()<span class="comment">//如果登录了，放行</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&#x27;/login&#x27;</span>) <span class="comment">//拦截到 登录页面</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="route和-router的区别"><a href="#route和-router的区别" class="headerlink" title="$route和$router的区别"></a>$route和$router的区别</h2><p>一个是路由，<strong>表示当前页面的路由对象</strong>；一个是路由器，记录了所有页面的对应的路由路径。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </p>
<p>在组件内可以通过<code>this.$route</code>或得<code>当前组件</code>对应的路径。</p>
<h2 id="404页面"><a href="#404页面" class="headerlink" title="404页面"></a>404页面</h2><p><code>&#123; path: &#39;*&#39;, component: NotFound &#125;</code>，<strong>路由的匹配顺序是声明顺序</strong>，通常写在最后，匹配不到组件就匹配这个组件 。</p>
<p>当我们使用的路由是<code>history路由</code>的时候，这个页面非常有用，因为后端为了防止使用history路由的页面，将前端路由发送到后端导致响应404，所以每当匹配不到资源的时候，后端都返回<code>index.html</code>，这样浏览器就会重新解析html，渲染页面，将路由控制权交给前端路由。但是这样也有缺点，就是如果用户请求的路径，既不对应后端资源也不对应前端页面，这种情况，确实需要响应404，我们就需要一个404页面来提示用户。</p>
<h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><p><strong>在vue2中</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//router/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router &#x27;</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">	<span class="attr">mode</span>: <span class="string">&#x27;history &#x27;</span> ,</span><br><span class="line">	<span class="attr">routes</span>: [],</span><br><span class="line">    <span class="attr">base</span>:<span class="string">&#x27;/api/&#x27;</span><span class="comment">//设置基础路径</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p><strong>在vue3中</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//router/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter,createwebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">    <span class="attr">history</span>: <span class="title function_">createwebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>)<span class="comment">//指定路由模式的同时指定基础路径,</span></span><br><span class="line">    <span class="attr">routes</span>: [],</span><br><span class="line">    <span class="attr">scrollBehavior</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">top</span>: <span class="number">0</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p><code>import.meta.env.BASE_URL</code>：路由<code>基地址</code>，导入的是vite的环境变量，可以通过修改<code>vite.config.js</code>文件的base属性来改变基地址，不能把<code>import.meta.env.BASE_URL</code>直接替换成<code>&#39;./&#39;</code>这种字面量。</p>
<p><code>scrollBehavior</code> 是 Vue Router 3.5.0 版本引入的一个功能，允许你定义一个滚动行为的函数，用于在导航时控制页面的滚动位置。</p>
<p>它和<code>routes</code>这个常见的配置项属于同级别的属性。</p>
<p><code>scrollBehavior</code> 函数接收三个参数：</p>
<ol>
<li><strong>to</strong>：即将进入的路由对象。</li>
<li><strong>from</strong>：即将离开的路由对象。</li>
<li><strong>savedPosition</strong>：仅当 <code>popstate</code> 导航（如用户点击浏览器的<code>前进/后退</code>按钮）时可用。这是一个<code>包含滚动位置的对象</code>（如果有保存的话），比如<code>&#123;top:20&#125;</code>。savedPosition记录的是用户点击前进或后退按钮时，的页面滚动位置</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params">to, <span class="keyword">from</span>, savedPosition</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (savedPosition) &#123;</span><br><span class="line">      <span class="keyword">return</span> savedPosition</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">top</span>: <span class="number">0</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这段代码会在用户点击浏览器的前进&#x2F;后退按钮时<strong>恢复之前保存的滚动位置</strong>；如果没有保存的位置，则<strong>默认滚动到顶部</strong>。</p>
<h3 id="创造实例方式"><a href="#创造实例方式" class="headerlink" title="创造实例方式"></a>创造实例方式</h3><ul>
<li>一个是使用<code>构造函数</code>创建router实例，一个是通过函数创造</li>
<li>使用的库都是vue-router</li>
<li>创造实例的时候传入的都是配置项</li>
</ul>
<h3 id="路由模式"><a href="#路由模式" class="headerlink" title="路由模式"></a>路由模式</h3><ul>
<li>vue2中控制路由用<code>mode</code>属性，history标识历史模式，hash是默认模式</li>
<li>vue3中控制路由模式用<code>history</code>属性，<code>createwebHistory</code>表示历史模式，<code>createwebHashHistory</code>表示哈希模式。</li>
</ul>
<h3 id="获取router-route对象方式"><a href="#获取router-route对象方式" class="headerlink" title="获取router&#x2F;route对象方式"></a>获取router&#x2F;route对象方式</h3><ul>
<li><p>vue2在组件中可以通过<code>this.$router/$route</code>获取，在js文件中则通过<strong>直接导入router</strong>的方式实现路由跳转。</p>
</li>
<li><p>在vue3中</p>
<p>在普通js文件中，也是通过<strong>直接导入router</strong>的方式实现路由跳转。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import router from &#x27;@/router&#x27;;</span><br><span class="line">// 执行导航操作</span><br><span class="line">router.push(&#x27;/some-path&#x27;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>在组件中（默认使用setup语法糖），通过useRoute, useRouter这两个api分别获取<code>当前页面路由对象</code>和<code>路由器对象</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//这些函数依赖于Vue的响应式系统和组件上下文，只能在组件内使用，在普通js文件中无法使用。</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">import</span> &#123; useRoute, useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>无论是再vue2还是在vue3中，在template中都能通过<code>$route</code>访问当前页面路由对象。</p>
</li>
</ul>
<h3 id="导航守卫-1"><a href="#导航守卫-1" class="headerlink" title="导航守卫"></a>导航守卫</h3><p>在 Vue 3 中，如果你使用的是 Vue Router 4，在某些情况下，你可以<strong>直接返回值</strong>（return）来代替调用 <code>next()</code>，这使得代码更加简洁，但是也要注意这样会<code>终止</code>导航守卫函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">matched</span>.<span class="title function_">some</span>(<span class="function"><span class="params">record</span> =&gt;</span> record.<span class="property">meta</span>.<span class="property">requiresAuth</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isAuthenticated</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;/login&#x27;</span>; <span class="comment">// 返回字符串作为重定向的目标路径，等效于next(&#x27;/login&#x27;)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">shouldBlockNavigation</span>(to)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 取消导航，等效于next(false)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;); </span><br></pre></td></tr></table></figure>

<h1 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h1><p>在vue2开发过程中使用的状态管理工具。</p>
<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><ul>
<li>某个状态在很多个组件来使用(个人信息)</li>
<li>多个组件共同维护一份数据比如(购物车)</li>
<li>数据传递存在困难用vuex就完事了</li>
</ul>
<h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><ul>
<li>共同维护同一份数据</li>
<li>响应式变化，响应式变化基于vue的响应式</li>
<li>操作简洁</li>
</ul>
<h2 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h2><p>创建vuecli项目时勾选vuex或者手动添加。</p>
<ul>
<li>安装vuex</li>
<li>在src新建文件store，新建文件index.js</li>
<li>在index文件中初始化插件：Vue.use(Vuex)；创造空仓库，配置仓库。</li>
<li>导出store对象，最后在创建根实例的时候传入这个store对象，它最终会被注入到每个组件实例中，也就是说<code>this.$store</code>是组件实例<strong>自己的属性</strong>。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> user <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> cart <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/cart&#x27;</span></span><br><span class="line"><span class="comment">//注册插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"><span class="comment">//Store显然是一个构造器</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">index</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="attr">setIndex</span>: <span class="function">(<span class="params">state, index</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">index</span> = index</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    user, cart</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//App是一个被vue-loader解析后的js对象</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="comment">//导入router对象,会先把router文件夹里的index.js里的代码运行</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"><span class="comment">// 导入store对象</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  <span class="comment">//h是createElement函数，用来创建虚拟结点(VNode),返回这个 VNode,告诉 Vue使用 App 组件作为根组件</span></span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="四大属性"><a href="#四大属性" class="headerlink" title="四大属性"></a>四大属性</h2><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p>提供唯一的公共数据源</p>
<p>无论组件内外，都是从store对象出发，来拿到state，不过获取store对象的方式不同。</p>
<p>组件内的可以通过<code>this.$store</code>拿到，在模板内可以直接使用<code>$store</code>(模板内默认去除this)，后面的3大属性同理。</p>
<p>组件外则通过import导入:<code>import store from &#39;./store&#39;</code>，直接拿到store实例。</p>
<p><strong>state中的数据的生命周期</strong></p>
<p><strong>初始化</strong>：当 Vuex store 被创建时，定义在 store 中的 state 也会一同被初始化。这意味着一旦应用启动，并创建了 Vuex store 实例，state 就会被初始化并准备好使用。</p>
<p><strong>页面刷新</strong>：默认情况下，Vuex 的 state 在页面刷新时会<strong>重新初始化</strong>。这是因为 state 存储在内存中，<strong>页面刷新会导致内存中的数据丢失</strong>。如果你需要在页面刷新后保持 state 数据，可以使用一些持久化存储的方法，如 localStorage 或者 sessionStorage。</p>
<p><strong>应用运行期间</strong>：在应用运行的过程中，state 可以通过 commit mutations 来直接改变，或通过 dispatch actions 后再 commit mutations 来间接改变。这是 Vuex 管理状态变化的主要方式，确保状态的变化是可追踪和预测的。</p>
<p><strong>路由变化</strong>：当用户在应用的不同路由之间导航时，除非明确改变了 state 或者触发了相关的 mutations&#x2F;actions，否则 state 不会因为路由变化而自动改变。</p>
<p><strong>组件销毁与重建</strong>：Vue 组件在其生命周期内，可能会被多次销毁和重建（例如，在动态路由或条件渲染下）。但是，只要 Vuex store 没有被销毁，state 将保持不变，不会因单个组件的销毁和重建受到影响。</p>
<p><strong>挂载位置</strong></p>
<p>模块中的state，最终会挂载在根仓库的state中，**无论模块是否开启命名空间(开启命名空间是防止命名冲突)**，但要注意的是根仓库中的属性直接通过<code>this.$store.state</code>就能拿到，比如<code>this.$store.state.index</code>，而模块中的属性需要通过<code>this.$store.state.module</code>才能拿到，路径更长，比如购物车模块中的购物车列表，通过<code>this.$store.state.cart.cartList</code>才能拿到。</p>
<p>例子如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">index</span>: <span class="number">0</span><span class="comment">//根仓库自己的属性</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    user, cart</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modules/cart.js</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">cartList</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,<span class="comment">//开启命名空间</span></span><br><span class="line">  state</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modules/user.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespace</span>:<span class="literal">false</span>,<span class="comment">//不开启命名空间</span></span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="comment">//页面刚加载完成，或者刷新，从本地存储中获取个人信息，更新info</span></span><br><span class="line">    <span class="comment">// 一旦 info 被初始化，后续对 info 的访问都是直接从 Vuex store 中获取已存储的值，不会再调用 getInfo 函数。</span></span><br><span class="line">    <span class="attr">info</span>: <span class="title function_">getInfo</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="..\images\vue\state.png" style="zoom:90%;" />

<img src="..\images\vue\state3.png" style="zoom:90%;" />

<p>可以看到user模块即便没有开启命名空间，其state中的数据也还是不会直接挂载在<code>this.$store.state</code>下，而是挂载在<code>this.$store.state.user</code>下。</p>
<h3 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h3><p>里面是一些修改&#x2F;维护state中的数据的函数，<strong>只能通过调用这里的函数来修改数据。</strong></p>
<p><strong>参数</strong>	</p>
<p>第一个参数是state，用来访问state中的数据，也同时说明了mutations只能同步修改数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="attr">setIndex</span>: <span class="function">(<span class="params">state, index</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">index</span> = index</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们在使用mutations中的方法的时候忽略第一个参数，我们传入的参数就是index，比如<code>this.$store.commit(&#39;setIndex&#39;,1)</code></p>
<p><strong>挂载位置</strong></p>
<p>是否开启命名空间，也不影响mutations的挂载位置。但是会影响挂载时候的属性名，举个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="attr">setIndex</span>: <span class="function">(<span class="params">state, index</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">index</span> = index</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    user, cart</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modules/cart.js</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="title function_">setCartList</span>(<span class="params">state, list</span>) &#123;&#125;,</span><br><span class="line">  <span class="title function_">toggleCheck</span>(<span class="params">state, goods_id</span>) &#123;&#125;,</span><br><span class="line">  <span class="title function_">toggleAllCheck</span>(<span class="params">state,flag</span>) &#123;&#125;,</span><br><span class="line">  <span class="title function_">changeCount</span>(<span class="params">state, obj</span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,<span class="comment">//开启命名空间</span></span><br><span class="line">  mutations</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modules/user.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespace</span>:<span class="literal">false</span>, 未开启命名空间</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">setUserInfo</span>(<span class="params">state, info</span>) &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="..\images\vue\mutations.png" style="zoom:85%;" />

<p>如图所示，cart模块开启了命名空间，所以属性名加上了<code>cart/</code>前缀，而user模块未开启，就不会加上前缀，如同根仓库中的mutations，但是无论开不开启命名空间，它们模块的mutations中的方法都是直接挂载在<code>this.$store._mutations</code>下的</p>
<p>然后我们使用commit调用mutations中的方法，就有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(属性名,参数)</span><br></pre></td></tr></table></figure>

<p>比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;cart/changeCount&#x27;</span>,<span class="number">3</span>)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;setIndex&#x27;</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>commit是Store实例的自己的属性，值是函数</p>
<h3 id="getter"><a href="#getter" class="headerlink" title="getter"></a>getter</h3><p>相当于计算属性，第一个参数也一般是state，第二个参数可以是getters(用来拿到getters中的属性)</p>
<p><strong>挂载位置</strong></p>
<p>是否开启命名空间，也不影响getter的挂载位置。但是会影响挂载时候的属性名，举个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">token</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">user</span>.<span class="property">info</span>.<span class="property">token</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    user, cart</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modules/cart.js</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="title function_">isAllChecked</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state.<span class="property">cartList</span>.<span class="title function_">every</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">checked</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">numOfAll</span>(<span class="params">state</span>) &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">numOfChecked</span>(<span class="params">state</span>) &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">sumPrice</span>(<span class="params">state</span>) &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">selectedGoods</span>(<span class="params">state</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,<span class="comment">//开启命名空间</span></span><br><span class="line">  getters</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modules/user.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">getters</span>:&#123;</span><br><span class="line">    <span class="title function_">name</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;tom&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="..\images\vue\getters.png" style="zoom:85%;" />

<p>如图所示，cart模块开启了命名空间，所以属性名加上了<code>cart/</code>前缀，而user模块未开启，就不会加上前缀，如同根仓库中的getter。</p>
<p>这一挂载规则就和mutations的挂载规则相同，因为getters本质也是函数啊。</p>
<p>然后我们访问的时候就有:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[属性名]</span><br></pre></td></tr></table></figure>

<p>比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;token&#x27;</span>]</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>.<span class="property">name</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;cart/numOfAll&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h3><p>里面是一些异步操作&#x2F;函数</p>
<p><strong>参数</strong></p>
<p>第一个参数是context（上下文），可以通过<code>context.commit()</code>调用<code>mutations</code>里的方法，来修改state，通过<code>context.dispatch()</code>调用<code>actions</code>里的方法；可以通过<code>context.state</code>拿到数据但是不能直接修改数据，总之就是雨露均沾。</p>
<p><strong>挂载位置</strong></p>
<p>原理和<code>mutations，getters</code>一样(三者本质都是函数啊），是否开启命名空间，也不影响actions的挂载位置，都挂载在<code>Store._actions</code>属性中。</p>
<p>然后调用的时候就有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;属性名&#x27;</span>，参数)<span class="comment">//类似mutations</span></span><br></pre></td></tr></table></figure>

<p><code>dispatch</code>和<code>commit</code>一样是Store实例的自己的属性，值是函数。</p>
<h2 id="辅助函数"><a href="#辅助函数" class="headerlink" title="辅助函数"></a>辅助函数</h2><p>在我们了解了各个属性在Store实例中的挂载位置后，我们拿到Store实例后，就知道如何访问，使用这四个属性了。</p>
<p>其实vuex还提供了<code>辅助函数</code>来简化操作。</p>
<p>四个属性，分别对应四个辅助函数，<code>mapState，mapMutations，mapActions，mapGetters</code></p>
<p>辅助函数内部本质其实也是使用<code>this.$store</code>来执行各种操作的，所以只能在组件中使用。</p>
<p>它们的使用方法是类似的。</p>
<h3 id="mapState"><a href="#mapState" class="headerlink" title="mapState"></a>mapState</h3><p>mapState返回的是一个对象，这个对象可以有多个属性，属性的值类型都是函数，都是<strong>计算属性</strong>，内部使用了<code>this.$store</code>来获取state中的数据。</p>
<img src="..\images\vue\state3.png" style="zoom:85%;" />

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">	<span class="attr">computed</span>: &#123;</span><br><span class="line">		...<span class="title function_">mapState</span>(<span class="string">&#x27;cart&#x27;</span>,[<span class="string">&#x27;cartList&#x27;</span>]),</span><br><span class="line">        ...<span class="title function_">mapState</span>([<span class="string">&#x27;index&#x27;</span>]),</span><br><span class="line">        ...<span class="title function_">mapState</span>(<span class="string">&#x27;user&#x27;</span>,[<span class="string">&#x27;info&#x27;</span>])<span class="comment">//报错，因为user未开启命名空间</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果使用辅助函数使用了传递了2个参数的形式，如图，则第一参数是模块名，<strong>要求必须开启命名空间</strong>。</p>
<h3 id="mapMutations"><a href="#mapMutations" class="headerlink" title="mapMutations"></a>mapMutations</h3><img src="..\images\vue\mutations.png" style="zoom:85%;" />

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="title function_">created</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setUserInfo</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;tom&#x27;</span>&#125;),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">changeCount</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">	<span class="attr">methods</span>:&#123;</span><br><span class="line">        ...<span class="title function_">mapMutations</span>(<span class="string">&#x27;cart&#x27;</span>,[<span class="string">&#x27;changeCount&#x27;</span>,<span class="string">&#x27;setCartList&#x27;</span>]),</span><br><span class="line">        ...<span class="title function_">mapMutations</span>([<span class="string">&#x27;setIndex&#x27;</span>,<span class="string">&#x27;setUserInfo&#x27;</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mapGetters"><a href="#mapGetters" class="headerlink" title="mapGetters"></a>mapGetters</h3><img src="..\images\vue\getters.png" style="zoom:85%;" />

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">	<span class="attr">computed</span>:&#123;</span><br><span class="line">        ...<span class="title function_">mapGetters</span>(<span class="string">&#x27;cart&#x27;</span>,[<span class="string">&#x27;isAllChecked&#x27;</span>,<span class="string">&#x27;numOfAll&#x27;</span>]),</span><br><span class="line">        ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;token&#x27;</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Pinia"><a href="#Pinia" class="headerlink" title="Pinia"></a>Pinia</h1><p>vue的最新<code>状态管理工具</code>，vuex的替代品。</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul>
<li><p>和Vue3新语法统一，提供符合<code>组合式</code>风格的API</p>
</li>
<li><p>提供更加简单的API（去掉了mutation，合并到actions)</p>
</li>
<li><p>去掉了<code>modules</code>的概念，替换为一个一个的<code>同级别</code>的store，他们都由pinia管理；</p>
<img src="..\images\vue\pinia.png" style="zoom: 67%;" />
</li>
<li><p>配合TypeScript更加友好，提供可靠的类型推断。</p>
</li>
</ul>
<h2 id="注册-1"><a href="#注册-1" class="headerlink" title="注册"></a>注册</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App. vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)  <span class="comment">//传入App.vue创建根实例</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">createPinia</span>()) <span class="comment">//注册pinia插件</span></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>) <span class="comment">//视图的挂载</span></span><br></pre></td></tr></table></figure>

<h2 id="组合式风格"><a href="#组合式风格" class="headerlink" title="组合式风格"></a>组合式风格</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cart.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="comment">//defineStore返回值的类型是一个函数，导出的就是这个函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, <span class="function">() =&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">100</span>)<span class="comment">//state</span></span><br><span class="line">	<span class="keyword">const</span> <span class="title function_">addCount</span> =(<span class="params"></span>) =&gt; &#123;count.<span class="property">value</span>++&#125;<span class="comment">//actions</span></span><br><span class="line">	<span class="keyword">const</span> <span class="title function_">subCount</span> =(<span class="params"></span>) =&gt;&#123;count.<span class="property">value</span>--&#125;<span class="comment">//actions</span></span><br><span class="line">	<span class="keyword">const</span> double = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> count.<span class="property">value</span> * <span class="number">2</span>)<span class="comment">//getters</span></span><br><span class="line">	<span class="keyword">const</span> msg = <span class="title function_">ref</span>(<span class="string">&#x27;hello pinia&#x27;</span>)<span class="comment">//state</span></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		count,double,addCount,subCount,msg<span class="comment">//返回</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)<span class="comment">//所以说在仓库里写组合式api风格的代码就行</span></span><br></pre></td></tr></table></figure>

<p><strong>特点</strong>:</p>
<ul>
<li>定义的变量就是state属性</li>
<li>定义的计算属性。即computed，就是getters</li>
<li>定义的函数，即function()，就是actions，支持异步操作，支持同步操作</li>
</ul>
<h2 id="选项式风格"><a href="#选项式风格" class="headerlink" title="选项式风格"></a>选项式风格</h2><p>个人还是一味的使用组合式了….</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="title function_">defineStore</span>(仓库的唯一标识,&#123;<span class="comment">//配置对象&#125; )</span></span><br></pre></td></tr></table></figure>

<h2 id="持久化插件"><a href="#持久化插件" class="headerlink" title="持久化插件"></a>持久化插件</h2><p>无论是vuex还是pinia，仓库中的数据是保存在内存中的，如果不使用持久化存储，<strong>当页面刷新或者关闭时</strong>，数据就会丢失。这是因为这些状态是存储在 JavaScript 运行时的内存中的，一旦页面卸载（比如刷新或关闭），这些数据就会被销毁。</p>
<h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="comment">//导入插件</span></span><br><span class="line"><span class="keyword">import</span> persist <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line">pinia.<span class="title function_">use</span>(persist)<span class="comment">//注册插件</span></span><br></pre></td></tr></table></figure>

<p>再指定要持久化的store，对于<code>组合式store</code>，需要在defineStore函数里再传入一个参数（第三个参数），{persist:true}。</p>
<p>对于<code>选项式store</code>，直接添加属性<code>persist：true</code>即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> category = <span class="title function_">defineStore</span>(<span class="string">&#x27;category&#x27;</span>,<span class="function">() =&gt;</span> &#123;&#125;,&#123;<span class="attr">persist</span>:<span class="literal">true</span>&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> category = <span class="title function_">defineStore</span>(<span class="string">&#x27;category&#x27;</span>,&#123;<span class="attr">persist</span>:<span class="literal">true</span>,<span class="attr">state</span>:&#123;&#125;&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><ul>
<li><strong>简化了localStorage的相关操作</strong>，会自动使用<code>JSON. stringify/JSON.parse</code>进行<code>序列化/反序列化</code>。值为函数和undefined的属性无法被序列化，Symbol属性和值为Symbol的属性无法被序列化。</li>
<li>存储到localStorage的键名默认是<code>仓库唯一标识</code>。</li>
<li>默认把仓库<strong>整个state</strong>做持久化，可以指定具体哪些数据做持久化。</li>
</ul>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设在stores/counter.js中定义了一个仓库</span></span><br><span class="line"><span class="comment">// stores/counter.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">//选项式风格</span></span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">doubleCount</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//在组件中使用</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/counter&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> counterStore = <span class="title function_">useCounterStore</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//我们可以发现无论是state还是getters还是actions，都可以直接通过store实例访问，非常方便啊</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> count = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> counterStore.<span class="property">count</span>); </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> doubleCount = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> counterStore.<span class="property">doubleCount</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; counterStore.<span class="title function_">increment</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在纯 JavaScript 文件（非 Vue 组件）中使用 Pinia store 需要一些<strong>额外的步骤</strong>，因为你<strong>没有 Vue 组件的上下文</strong>（比如 <code>setup()</code> 函数）。你需要确保 Pinia 已经被安装并且可以访问到，最好不要写到js文件的<code>全局作用域</code>中。</p>
<p>所以说vue3中给两大插件pinia，router提供的api；router的<code>useRoute和useRouter</code>只能在组件中使用，pinia的useStore虽然不是只能在组件中调用，但是在js文件中使用起来也是有限制的。</p>
<p><strong>与vuex的区别</strong></p>
<p>vue2中要使用vuex中的哪个数据，调用哪个方法，都是单独获取，而Vue3是一个一个<code>store</code>整体导入使用。</p>
<h1 id="Vue-cli"><a href="#Vue-cli" class="headerlink" title="Vue-cli"></a>Vue-cli</h1><h2 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h2><p>vue使用webpack进行模块化开发，但是webpack的配置工作是一个很繁琐的过程，所以出现了vue-cli这个<strong>脚手架工具</strong>，它可以帮助我们快速创建一个开发vue项目的标准化webpack配置。</p>
<h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm i @vue/cli -g<span class="comment">//全局安装，安装一次就行，之后就可以在任意目录执行以下指令</span></span><br><span class="line">vue --version<span class="comment">//查看Vue版本</span></span><br><span class="line">vue create project-<span class="title function_">name</span>(项目名不能用中文)<span class="comment">//创建项目架子</span></span><br><span class="line">npm run serve <span class="comment">//启动项目，查看package.json可知</span></span><br></pre></td></tr></table></figure>

<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><ul>
<li><p>node_modules：存储项目的所有 npm 依赖包。</p>
</li>
<li><p>public：存放<code>静态资源</code>，如 index.html 和 favicon.ico，这些文件不会被 webpack 处理，而是会直接被打包进最终文件。</p>
</li>
<li><p>src：源代码的主要目录</p>
<ul>
<li><p>assets：用于存放静态资源文件，如图片、字体等，<strong>会被 webpack 处理</strong>。</p>
</li>
<li><p>components ：存放 .vue 单文件组件</p>
</li>
<li><p>views：存放页面</p>
</li>
<li><p>App.vue：根组件，整个应用的入口点。</p>
</li>
<li><p>main.js：应用程序的入口脚本，通常在这里创建 Vue 实例(根实例)。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>package.json：项目元数据和依赖关系列表，以及 npm 脚本(script)。</p>
</li>
<li><p>vue.config.js：Vue CLI 的可选配置文件，用于<strong>自定义构建设置</strong></p>
</li>
<li><p>babel.config.js：<strong>Babel 的配置文件</strong>，用于转换 ES6+ 代码。它可以帮助你将现代 JavaScript 特性（ES6+）转换为向后兼容的 JavaScript 版本。</p>
</li>
</ul>
<h2 id="json-server"><a href="#json-server" class="headerlink" title="json-server"></a>json-server</h2><p>是一个轻量级的 Node.js 模块，可以让你快速地启动一个具有 REST API 的 JSON 文件数据库服务器。它提供了一个简单的、可立即使用的后端。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g json-server</span><br></pre></td></tr></table></figure>

<p>在项目根目录下创建一个文件，比如 db.json，并填充一些数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;posts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span> <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hello World&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span> <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span> <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Second Post&quot;</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;comments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span> <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Some comment&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;postId&quot;</span><span class="punctuation">:</span> <span class="number">1</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>在db.json文件所在目录下执行<code>json-server --watch db.json</code>，这会启动一个默认监听在<code>http://localhost:3000</code>的服务器</p>
<p>使用各种 <code>HTTP 请求工具</code>（如 Postman 或 cURL）或前端框架中的 AJAX 请求来与之交互，比如可以发送一个 GET 请求到<code>http://localhost:3000/posts</code>来获取所有的帖子</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.sanye.blog">三叶sanye</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.sanye.blog/posts/8b27fabc.html">https://www.sanye.blog/posts/8b27fabc.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.sanye.blog" target="_blank">三叶的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/vue/">vue</a></div><div class="post-share"><div class="social-share" data-image="/images/cover/preview.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/d04bd5bc.html" title="操作系统"><img class="cover" src="/images/cover/%E6%98%9F%E7%A9%BA.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">操作系统</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/e19785da.html" title="uniapp"><img class="cover" src="/images/cover/%E4%BA%91%E6%B9%96%E5%B0%91%E5%A5%B3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">uniapp</div></div><div class="info-2"><div class="info-item-1"> 笔记内容主要参考uni-app官方文档，仔细阅读uni-app官方文档 介绍和教程等部分能获得更多内容。  什么是uni-app是一个使用 Vue.js 开发所有前端应用的框架，开发者编写一套代码，可发布到iOS、Android、Web（响应式）、以及各种小程快应用等多个平台。 uni-app的由来：uni-app官网 HBuilderXHBuilderX是通用的前端开发工具，但为uni-app做了特别强化，和uni-app属于同一家公司的产品。 基本配置 插件下载：工具-&gt;插件下载 快捷方式定制：工具-&gt;预定快捷方案 tab补全代码：工具-&gt;设置-&gt;语言服务配置 保存代码格式化：工具-&gt;设置-&gt;编辑器配置 合并代码时显示最后一行代码：工具-&gt;设置-&gt;编辑器配置  创建一个uni-app项目在点击工具栏里的文件 -&gt; 新建 -&gt; 项目 选择uni-app类型，输入工程名，选择模板，点击创建，即可成功创建。   uni-app自带的模板有默认的空项目模板、Hello uni-app...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/f33bd2b9.html" title="前端面试---vue部分"><img class="cover" src="/images/cover/%E5%B0%8F%E9%95%87.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-13</div><div class="info-item-2">前端面试---vue部分</div></div><div class="info-2"><div class="info-item-1">Vue2推荐一个学习vue的网站：Vue3 说说你对vue的理解前端发展背景最早的网页是没有数据库的，可以理解成就是一张可以在网络上浏览的报纸，就是纯静态页面 直到CGI技术的出现通过 CGI Perl 运行一小段代码与数据库或文件系统进行交互(前后端交互) 后来JSP(Java Server Pages)技术取代了CGI技术，其实就是Java + HTML 1234567891011&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot; pageEncoding=&quot;utf-8&quot;%&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;title&gt;JSP demo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;img...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/%E4%B8%89%E5%8F%B6.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">三叶sanye</div><div class="author-info-description">记录学习，分享知识</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://space.bilibili.com/660655866?spm_id_from=333.1007.0.0" rel="external nofollow noreferrer" target="_blank" title="Bilibli"><i class="fa-brands fa-bilibili" style="color: #74C0FC;"></i></a><a class="social-icon" href="https://github.com/syhy" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:3519450570@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">笔记主要自用，希望也能帮到你😀</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue2"><span class="toc-number">1.</span> <span class="toc-text">Vue2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E5%80%BC%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">插值表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4"><span class="toc-number">1.2.</span> <span class="toc-text">指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#v-html"><span class="toc-number">1.2.1.</span> <span class="toc-text">v-html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-if-v-show"><span class="toc-number">1.2.2.</span> <span class="toc-text">v-if&#x2F;v-show</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-else-v-else-if"><span class="toc-number">1.2.3.</span> <span class="toc-text">v-else&#x2F;v-else-if</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-on"><span class="toc-number">1.2.4.</span> <span class="toc-text">v-on</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-bind"><span class="toc-number">1.2.5.</span> <span class="toc-text">v-bind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-for"><span class="toc-number">1.2.6.</span> <span class="toc-text">v-for</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-model"><span class="toc-number">1.2.7.</span> <span class="toc-text">v-model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="toc-number">1.2.8.</span> <span class="toc-text">指令修饰符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7computed"><span class="toc-number">1.3.</span> <span class="toc-text">计算属性computed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8watch"><span class="toc-number">1.4.</span> <span class="toc-text">监听器watch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watch%E5%92%8Ccomputed%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB"><span class="toc-number">1.5.</span> <span class="toc-text">watch和computed的区别与联系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#method%E5%92%8Ccomputed%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB"><span class="toc-number">1.6.</span> <span class="toc-text">method和computed的区别与联系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.7.</span> <span class="toc-text">vue性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E4%BC%98%E5%8C%96"><span class="toc-number">1.7.1.</span> <span class="toc-text">编码优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.7.2.</span> <span class="toc-text">加载优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MVVM"><span class="toc-number">1.8.</span> <span class="toc-text">MVVM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#model"><span class="toc-number">1.8.1.</span> <span class="toc-text">model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#view"><span class="toc-number">1.8.2.</span> <span class="toc-text">view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#viewmodel"><span class="toc-number">1.8.3.</span> <span class="toc-text">viewmodel</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue3"><span class="toc-number">2.</span> <span class="toc-text">Vue3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#setup%EF%BC%88%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">setup（）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E7%BB%84%E5%90%88%E5%BC%8Fapi%E4%B8%AD%E7%9A%84%E5%86%99%E6%B3%95"><span class="toc-number">2.1.1.</span> <span class="toc-text">在组合式api中的写法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E7%B3%96%E5%86%99%E6%B3%95"><span class="toc-number">2.1.2.</span> <span class="toc-text">语法糖写法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setup%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.3.</span> <span class="toc-text">setup的参数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#props"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">props</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#context"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">context</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reactive%E5%92%8Cref"><span class="toc-number">2.2.</span> <span class="toc-text">reactive和ref</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reactive"><span class="toc-number">2.2.1.</span> <span class="toc-text">reactive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ref"><span class="toc-number">2.2.2.</span> <span class="toc-text">ref</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#toRef-%E5%92%8CtoRefs"><span class="toc-number">2.3.</span> <span class="toc-text">toRef()和toRefs()</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E4%B8%A2%E5%A4%B1"><span class="toc-number">2.3.1.</span> <span class="toc-text">响应式丢失</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRef"><span class="toc-number">2.3.2.</span> <span class="toc-text">toRef()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRefs"><span class="toc-number">2.3.3.</span> <span class="toc-text">toRefs()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#computed"><span class="toc-number">2.4.</span> <span class="toc-text">computed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watch"><span class="toc-number">2.5.</span> <span class="toc-text">watch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">2.6.</span> <span class="toc-text">生命周期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%E5%BC%8F"><span class="toc-number">2.6.1.</span> <span class="toc-text">选项式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%BC%8F"><span class="toc-number">2.6.2.</span> <span class="toc-text">组合式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">2.7.</span> <span class="toc-text">组件通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#props%E4%B8%8Eemit"><span class="toc-number">2.7.1.</span> <span class="toc-text">props与emit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6%E4%BC%A0%E5%AD%90"><span class="toc-number">2.7.1.1.</span> <span class="toc-text">父传子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="toc-number">2.7.1.2.</span> <span class="toc-text">子传父</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8Evue2%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.7.1.3.</span> <span class="toc-text">与vue2的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#provide%E4%B8%8Ereject"><span class="toc-number">2.7.2.</span> <span class="toc-text">provide与reject</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#provide"><span class="toc-number">2.7.2.1.</span> <span class="toc-text">provide</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#inject"><span class="toc-number">2.7.2.2.</span> <span class="toc-text">inject</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="toc-number">2.7.2.3.</span> <span class="toc-text">响应式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8Evue2%E7%9A%84%E5%8C%BA%E5%88%AB-1"><span class="toc-number">2.7.2.4.</span> <span class="toc-text">与vue2的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E7%94%A8"><span class="toc-number">2.8.</span> <span class="toc-text">模板引用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.8.1.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8Evue2%E4%B8%ADref-ref%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB"><span class="toc-number">2.8.2.</span> <span class="toc-text">与vue2中ref&#x2F;$ref的区别与联系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#defineExpose"><span class="toc-number">2.9.</span> <span class="toc-text">defineExpose()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue-Router"><span class="toc-number">3.</span> <span class="toc-text">Vue-Router</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8"><span class="toc-number">3.1.</span> <span class="toc-text">单页面应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%AF%BC%E8%88%AA"><span class="toc-number">3.2.</span> <span class="toc-text">路由导航</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E5%AF%BC%E8%88%AArouter-link"><span class="toc-number">3.2.1.</span> <span class="toc-text">声明式导航router-link</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%BC%8F%E5%AF%BC%E8%88%AA"><span class="toc-number">3.2.2.</span> <span class="toc-text">编程式导航</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97"><span class="toc-number">3.2.3.</span> <span class="toc-text">参数接受</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E8%B7%AF%E7%94%B1"><span class="toc-number">3.2.4.</span> <span class="toc-text">嵌套路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91redirect"><span class="toc-number">3.2.5.</span> <span class="toc-text">重定向redirect</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%87%BA%E5%8F%A3router-view"><span class="toc-number">3.3.</span> <span class="toc-text">路由出口router-view</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB"><span class="toc-number">3.4.</span> <span class="toc-text">导航守卫</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#next"><span class="toc-number">3.4.1.</span> <span class="toc-text">next()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%AE%88%E5%8D%AB"><span class="toc-number">3.4.2.</span> <span class="toc-text">局部守卫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%AE%88%E5%8D%AB"><span class="toc-number">3.4.3.</span> <span class="toc-text">全局守卫</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#route%E5%92%8C-router%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">3.5.</span> <span class="toc-text">$route和$router的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#404%E9%A1%B5%E9%9D%A2"><span class="toc-number">3.6.</span> <span class="toc-text">404页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB"><span class="toc-number">3.7.</span> <span class="toc-text">区别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E9%80%A0%E5%AE%9E%E4%BE%8B%E6%96%B9%E5%BC%8F"><span class="toc-number">3.7.1.</span> <span class="toc-text">创造实例方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.7.2.</span> <span class="toc-text">路由模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96router-route%E5%AF%B9%E8%B1%A1%E6%96%B9%E5%BC%8F"><span class="toc-number">3.7.3.</span> <span class="toc-text">获取router&#x2F;route对象方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB-1"><span class="toc-number">3.7.4.</span> <span class="toc-text">导航守卫</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vuex"><span class="toc-number">4.</span> <span class="toc-text">Vuex</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF"><span class="toc-number">4.1.</span> <span class="toc-text">场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF"><span class="toc-number">4.2.</span> <span class="toc-text">优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C"><span class="toc-number">4.3.</span> <span class="toc-text">注册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E5%A4%A7%E5%B1%9E%E6%80%A7"><span class="toc-number">4.4.</span> <span class="toc-text">四大属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#state"><span class="toc-number">4.4.1.</span> <span class="toc-text">state</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mutations"><span class="toc-number">4.4.2.</span> <span class="toc-text">mutations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getter"><span class="toc-number">4.4.3.</span> <span class="toc-text">getter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#actions"><span class="toc-number">4.4.4.</span> <span class="toc-text">actions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.</span> <span class="toc-text">辅助函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mapState"><span class="toc-number">4.5.1.</span> <span class="toc-text">mapState</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mapMutations"><span class="toc-number">4.5.2.</span> <span class="toc-text">mapMutations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mapGetters"><span class="toc-number">4.5.3.</span> <span class="toc-text">mapGetters</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pinia"><span class="toc-number">5.</span> <span class="toc-text">Pinia</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">5.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C-1"><span class="toc-number">5.2.</span> <span class="toc-text">注册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%BC%8F%E9%A3%8E%E6%A0%BC"><span class="toc-number">5.3.</span> <span class="toc-text">组合式风格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%E5%BC%8F%E9%A3%8E%E6%A0%BC"><span class="toc-number">5.4.</span> <span class="toc-text">选项式风格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E6%8F%92%E4%BB%B6"><span class="toc-number">5.5.</span> <span class="toc-text">持久化插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">5.5.1.</span> <span class="toc-text">使用步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">5.5.2.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">5.6.</span> <span class="toc-text">使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue-cli"><span class="toc-number">6.</span> <span class="toc-text">Vue-cli</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">6.1.</span> <span class="toc-text">是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="toc-number">6.2.</span> <span class="toc-text">快速开始</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">6.3.</span> <span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json-server"><span class="toc-number">6.4.</span> <span class="toc-text">json-server</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/19656fd5.html" title="react"><img src="/images/cover/%E6%B1%9F%E5%8D%97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="react"/></a><div class="content"><a class="title" href="/posts/19656fd5.html" title="react">react</a><time datetime="2025-02-20T13:33:23.000Z" title="发表于 2025-02-20 21:33:23">2025-02-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/518e617c.html" title="git"><img src="/images/cover/dog.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="git"/></a><div class="content"><a class="title" href="/posts/518e617c.html" title="git">git</a><time datetime="2025-02-09T08:07:36.000Z" title="发表于 2025-02-09 16:07:36">2025-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b0415b82.html" title="前端刷题记录"><img src="/images/cover/%E6%98%9F%E7%A9%BA.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前端刷题记录"/></a><div class="content"><a class="title" href="/posts/b0415b82.html" title="前端刷题记录">前端刷题记录</a><time datetime="2025-02-09T07:04:01.000Z" title="发表于 2025-02-09 15:04:01">2025-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e255a10a.html" title="计算机网络"><img src="/images/cover/maomao.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机网络"/></a><div class="content"><a class="title" href="/posts/e255a10a.html" title="计算机网络">计算机网络</a><time datetime="2025-02-07T15:08:21.000Z" title="发表于 2025-02-07 23:08:21">2025-02-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4b0178e0.html" title="数据结构与算法"><img src="/images/cover/%E7%A7%98%E5%AF%86%E9%A3%8E%E6%99%AF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与算法"/></a><div class="content"><a class="title" href="/posts/4b0178e0.html" title="数据结构与算法">数据结构与算法</a><time datetime="2025-02-07T14:48:29.000Z" title="发表于 2025-02-07 22:48:29">2025-02-07</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/images/cover/1.png);"><div id="footer-wrap"><div class="footer_custom_text"><div id="sanye"><svg class="icon" aria-hidden="true"><use href="#icon-banquan"></use></svg><span>2024 - 2025 By 三叶sanye</span><svg class="icon" aria-hidden="true"><use href="#icon-sanyecao"></use></svg></div><div id="runtime"></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://unpkg.com/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script src="/js/time.js"></script><script src="/js/iconfont.js"></script><script defer="defer" id="ribbon" src="https://unpkg.com/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://unpkg.com/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://unpkg.com/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="/js/busuanzi.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"display":{"position":"left","width":120,"height":240},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>